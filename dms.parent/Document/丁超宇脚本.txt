--维修项目主表
CREATE TABLE tm_labour_group (
  DEALER_CODE varchar(30) DEFAULT NULL COMMENT '经销商代码',
  MAIN_GROUP_CODE varchar(30) NOT NULL COMMENT '主分类码',
  MAIN_GROUP_NAME varchar(60) DEFAULT NULL COMMENT '主分类名称',
  DOWN_TAG int(8) DEFAULT NULL COMMENT 'OEM标志',
  CREATED_BY varchar(30) DEFAULT NULL COMMENT 'CREATED_BY',
  CREATED_AT datetime DEFAULT NULL COMMENT 'CREATED_AT',
  UPDATED_BY varchar(30) DEFAULT NULL COMMENT 'UPDATED_BY',
  UPDATED_AT datetime DEFAULT NULL COMMENT 'UPDATED_AT',
  VER DECIMAL(5,0) DEFAULT 0 COMMENT 'VER',
  CONSTRAINT PK_TM_LABOUR_GROUP PRIMARY KEY (DEALER_CODE,MAIN_GROUP_CODE)
) ENGINE=InnoDB AUTO_INCREMENT=55 DEFAULT CHARSET=utf8 COMMENT='维修项目大类';
--维修项目副表
CREATE TABLE tm_labour_subgroup (
  DEALER_CODE varchar(30) DEFAULT NULL COMMENT '经销商代码',
  MAIN_GROUP_CODE varchar(30) NOT NULL COMMENT '主分类码',
  SUB_GROUP_CODE varchar(30) NOT NULL COMMENT '二级分类码',
  SUB_GROUP_NAME varchar(60) DEFAULT NULL COMMENT '二级分类名称',
  DOWN_TAG int(8) DEFAULT NULL COMMENT '是，否',
  CREATED_BY varchar(30) DEFAULT NULL COMMENT 'CREATED_BY',
  CREATED_AT datetime DEFAULT NULL COMMENT 'CREATED_AT',
  UPDATED_BY varchar(30) DEFAULT NULL COMMENT 'UPDATED_BY',
  UPDATED_AT datetime DEFAULT NULL COMMENT 'UPDATED_AT',
  VER DECIMAL(5,0) DEFAULT 0 COMMENT 'VER',
  CONSTRAINT P_LAB_SUBGROUP PRIMARY KEY (DEALER_CODE, MAIN_GROUP_CODE, SUB_GROUP_CODE)
) ENGINE=InnoDB AUTO_INCREMENT=69 DEFAULT CHARSET=utf8 COMMENT='维修项目小类';
--计量单位表
CREATE TABLE
    tm_unit
    (
        DEALER_CODE VARCHAR(30) NOT NULL,
        UNIT_CODE VARCHAR(4) NOT NULL,
        UNIT_NAME VARCHAR(12),
        CREATED_BY VARCHAR(30),
        CREATED_AT DATETIME,
        UPDATED_BY VARCHAR(30),
        UPDATED_AT DATETIME,
        VER DECIMAL(5,0) DEFAULT 0,
        DDCN_UPDATED_AT DATETIME,
        PRIMARY KEY (DEALER_CODE, UNIT_CODE)
    );
--配件会计月报表
CREATE TABLE
    TT_PART_PERIOD_REPORT
    (
        DEALER_CODE varchar(30) NOT NULL,
        REPORT_MONTH VARCHAR(2) NOT NULL,
        REPORT_YEAR VARCHAR(4) NOT NULL,
        STORAGE_CODE varchar(4) NOT NULL,
        PART_BATCH_NO VARCHAR(30) NOT NULL,
        PART_NO VARCHAR(27) NOT NULL,
        PART_NAME VARCHAR(120),
        OPEN_QUANTITY double(8,2),
        OPEN_PRICE double(12,4),
        OPEN_AMOUNT double(12,4),
        IN_QUANTITY double(8,2),
        STOCK_IN_AMOUNT double(12,2),
        BUY_IN_COUNT double(8,2),
        BUY_IN_AMOUNT double(12,2),
        ALLOCATE_IN_COUNT double(8,2),
        ALLOCATE_IN_AMOUNT double(12,2),
        TRANSFER_IN_COUNT double(8,2),
        TRANSFER_IN_AMOUNT double(12,2),
        OTHER_IN_COUNT double(8,2),
        OTHER_IN_AMOUNT double(12,2),
        PROFIT_IN_COUNT double(8,2),
        PROFIT_IN_AMOUNT double(12,2),
        OUT_QUANTITY double(8,2),
        STOCK_OUT_COST_AMOUNT double(12,4),
        OUT_AMOUNT double(12,4),
        REPAIR_OUT_COUNT double(8,2),
        REPAIR_OUT_COST_AMOUNT double(12,2),
        REPAIR_OUT_SALE_AMOUNT double(12,2),
        SALE_OUT_COUNT double(8,2),
        SALE_OUT_COST_AMOUNT double(12,2),
        SALE_OUT_SALE_AMOUNT double(12,2),
        INNER_OUT_COUNT double(8,2),
        INNER_OUT_COST_AMOUNT double(12,2),
        INNER_OUT_SALE_AMOUNT double(12,2),
        ALLOCATE_OUT_COUNT double(8,2),
        ALLOCATE_OUT_COST_AMOUNT double(12,2),
        ALLOCATE_OUT_SALE_AMOUNT double(12,2),
        TRANSFER_OUT_COUNT double(8,2),
        TRANSFER_OUT_COST_AMOUNT double(12,2),
        OTHER_OUT_COUNT double(8,2),
        OTHER_OUT_COST_AMOUNT double(12,2),
        OTHER_OUT_SALE_AMOUNT double(12,2),
        LOSS_OUT_COUNT double(8,2),
        LOSS_OUT_AMOUNT double(12,2),
        CLOSE_QUANTITY double(8,2),
        CLOSE_PRICE double(12,4),
        CLOSE_AMOUNT double(12,4),
        UPHOLSTER_OUT_COUNT double(8,2),
        UPHOLSTER_OUT_COST_AMOUNT double(12,2),
        UPHOLSTER_OUT_SALE_AMOUNT double(12,2),
        D_KEY double(1,0) DEFAULT 0,
        CREATED_BY varchar(30),
        CREATED_AT datetime,
        UPDATED_BY varchar(30),
        UPDATED_AT datetime,
        DDCN_UPDATED_AT datetime,
        PRIMARY KEY (REPORT_MONTH, REPORT_YEAR, DEALER_CODE,
        PART_BATCH_NO, STORAGE_CODE, PART_NO)
    )ENGINE=InnoDB DEFAULT CHARSET=utf8;
CREATE TABLE `tt_part_cost_adjust` (
  `DEALER_CODE` varchar(30) NOT NULL COMMENT '经销商代码',
  `ADJUST_NO` varchar(30) NOT NULL COMMENT '成本调整单号',
  `STORAGE_CODE` varchar(30) DEFAULT NULL COMMENT '仓库代码',
  `STORAGE_POSITION_CODE` varchar(30) DEFAULT NULL COMMENT '库位',
  `PART_NO` varchar(30) DEFAULT NULL COMMENT '配件代码',
  `PART_NAME` varchar(120) DEFAULT NULL COMMENT '配件名称',
  `PART_BATCH_NO` varchar(30) DEFAULT NULL COMMENT '配件代码',
  `STOCK_QUANTITY` double(8,4) DEFAULT '0.0000' COMMENT '账面库存\r\n            可用库存= 账面库存+借进-借出-锁定\r\n            ',
  `COST_PRICE` double(10,2) DEFAULT '0.00' COMMENT '最新不含税单价',
  `COST_AMOUNT` double(10,2) DEFAULT '0.00' COMMENT '原成本金额',
  `NEW_PRICE` double(10,2) DEFAULT NULL COMMENT '新成本价',
  `NEW_AMOUNT` double(10,2) DEFAULT NULL COMMENT '新成本金额',
  `ADJUSTER` varchar(4) DEFAULT NULL COMMENT '调整人',
  `ADJUSTD_AT` datetime DEFAULT NULL COMMENT '调整日期',
  `D_KEY` DECIMAL(1,0) DEFAULT '0',
  `CREATED_BY` varchar(30) DEFAULT NULL COMMENT 'CREATED_BY',
  `CREATED_AT` datetime DEFAULT NULL COMMENT 'CREATED_AT',
  `UPDATED_BY` varchar(30) DEFAULT NULL COMMENT 'UPDATED_BY',
  `UPDATED_AT` datetime DEFAULT NULL COMMENT 'UPDATED_AT',
  `VER` DECIMAL(5,0) DEFAULT '0',
  PRIMARY KEY (`DEALER_CODE`,`ADJUST_NO`)
) ENGINE=InnoDB AUTO_INCREMENT=69 DEFAULT CHARSET=utf8 COMMENT='配件成本价调整流水账';
CREATE TABLE
    TT_PART_ABCD_TEMP
    (
        DEALER_CODE CHARACTER(8),
        ROW_NO DECIMAL(14,0),
        PART_NO VARCHAR(30),
        PART_NAME VARCHAR(120),
        PART_MODEL_GROUP_CODE_SET VARCHAR(90),
        ABC_TYPE DECIMAL(8,0),
        SET_ABC_TYPE DECIMAL(8,0),
        STOCK_QUANTITY DECIMAL(10,2),
        UNIT_CODE VARCHAR(4),
        SALES_PRICE DECIMAL(10,2),
        CLAIM_PRICE DECIMAL(10,2),
        COST_PRICE DECIMAL(10,2),
        MAX_STOCK DECIMAL(10,2),
        MIN_STOCK DECIMAL(10,2),
        PART_OUT_COUNT DECIMAL(10,2),
        PART_OUT_AMOUNT DECIMAL(10,2),
        ABCD_YEAR CHARACTER(4),
        ABCD_MONTH CHARACTER(2),
        ADD_PART_AMOUNT DECIMAL(10,2),
        ADD_PART_AMOUNT_RATE DECIMAL(10,2)
    );
CREATE TABLE
    TM_PART_BACK
    (
        DEALER_CODE varchar(30) NOT NULL,
        ITEM_ID bigint(15) NOT NULL,
        BACK_CODE VARCHAR(120),
        IS_STOCK_OUT DECIMAL(8,0),
        STORAGE_CODE CHARACTER(4),
        PART_NO VARCHAR(27),
        ITEM_ID_PART DECIMAL(14,0),
        CREATED_BY DECIMAL(14,0),
        CREATED_AT datetime,
        D_KEY DECIMAL(1,0) DEFAULT 0,
        UPDATE_BY DECIMAL(14,0),
        UPDATE_DATE datetime,
        VER DECIMAL(5,0) DEFAULT 0,
        CONSTRAINT P_PT_BACK PRIMARY KEY (DEALER_CODE, ITEM_ID)
    );
CREATE TABLE
    TT_PART_ALLOCATE_OUT_ITEM
    (
        ITEM_ID DECIMAL(14,0) NOT NULL,
        DEALER_CODE VARCHAR(30),
        ALLOCATE_OUT_NO CHARACTER(12),
        STORAGE_CODE CHARACTER(4),
        STORAGE_POSITION_CODE VARCHAR(30),
        PART_BATCH_NO VARCHAR(30),
        PART_NO VARCHAR(27),
        PART_NAME VARCHAR(120),
        UNIT_CODE VARCHAR(10),
        OUT_QUANTITY DECIMAL(8,2),
        COST_PRICE DECIMAL(12,4) DEFAULT 0,
        COST_AMOUNT DECIMAL(12,4) DEFAULT 0,
        OUT_PRICE DECIMAL(12,4),
        OUT_AMOUNT DECIMAL(12,4),
        D_KEY DECIMAL(1,0) DEFAULT 0,
        CREATED_BY DECIMAL(14,0),
        CREATED_AT datetime DEFAULT NULL,
        UPDATED_BY DECIMAL(14,0),
        UPDATED_AT datetime DEFAULT NULL,
        VER DECIMAL(5,0) DEFAULT 0,
        RECEIVE_REMARK VARCHAR(300),
        PART_COST_PRICE DECIMAL(12,4),
        PART_COST_AMOUNT DECIMAL(12,4),
        DDCN_UPDATE_DATE datetime DEFAULT NULL,
        OTHER_PART_COST_AMOUNT DECIMAL(12,4) DEFAULT 0.00,
        OTHER_PART_COST_PRICE DECIMAL(12,4) DEFAULT 0.00,
        CONSTRAINT P_ALLO_OUT_I PRIMARY KEY (ITEM_ID),
        CONSTRAINT F_P_ALLO_OUT_I FOREIGN KEY (DEALER_CODE, ALLOCATE_OUT_NO) REFERENCES
        TT_PART_ALLOCATE_OUT (DEALER_CODE, ALLOCATE_OUT_NO) ON
    DELETE
        RESTRICT
    ON
    UPDATE
        RESTRICT
    );
CREATE TABLE
    TT_PART_ALLOCATE_OUT
    (
        DEALER_CODE varchar(30) NOT NULL,
        ALLOCATE_OUT_NO varchar(12) NOT NULL,
        CUSTOMER_CODE varchar(12),
        CUSTOMER_NAME varchar(120),
        COST_AMOUNT DECIMAL(12,4) DEFAULT 0,
        OUT_AMOUNT DECIMAL(12,4),
        HANDLER varchar(30),
        STOCK_OUT_DATE datetime DEFAULT NULL,
        IS_FINISHED DECIMAL(8,0) DEFAULT 12781002,
        FINISHED_DATE datetime DEFAULT NULL,
        IS_PAYOFF DECIMAL(8,0) DEFAULT 12781002,
        IS_PAYOFF_FINANCE DECIMAL(8,0),
        CREDENCE_FINANCE VARCHAR(60),
        F_PAY_OFF_DATE TIMESTAMP,
        LOCK_USER CHARACTER(20),
        CREDENCE VARCHAR(60),
        PAY_OFF_DATE datetime DEFAULT NULL,
        PAY_OFF_TAX DECIMAL(3,2),
        F_PAY_OFF_TAX DECIMAL(3,2),
        REMARK VARCHAR(400),
        D_KEY DECIMAL(1,0) DEFAULT 0,
        CREATED_BY DECIMAL(14,0),
        CREATED_AT datetime DEFAULT NULL,
        UPDATED_BY DECIMAL(14,0),
        UPDATED_AT datetime DEFAULT NULL,
        VER DECIMAL(5,0) DEFAULT 0,
        PAY_OFF_MAN VARCHAR(30),
        DXP_DATE datetime DEFAULT NULL,
        F_PAY_OFF_AMOUNT DECIMAL(12,2),
        F_NOT_PAY_OFF_AMOUNT DECIMAL(12,2),
        DDCN_UPDATE_DATE datetime DEFAULT NULL,
        CONSTRAINT P_P_ALLOCATE_OUT PRIMARY KEY (DEALER_CODE, ALLOCATE_OUT_NO)
    );
CREATE TABLE
    TT_PART_WORKSHOP_ITEM
    (
        ITEM_ID BIGINT(15) NOT NULL,
        DEALER_CODE VARCHAR(30) NOT NULL,
        RO_NO VARCHAR(12),
        STORAGE_CODE VARCHAR(10),
        STORAGE_POSITION_CODE VARCHAR(30),
        PART_BATCH_NO VARCHAR(30),
        PART_NO VARCHAR(27),
        PART_NAME VARCHAR(120),
        UNIT_CODE VARCHAR(10),
        PART_COST_PRICE double(12,4),
        PART_SALES_PRICE double(10,2),
        PART_COST_AMOUNT double(12,4),
        PART_SALES_AMOUNT double(12,2),
        LEND_QUANTITY DECIMAL(8,2) DEFAULT 0,
        BORROWER VARCHAR(10),
        SENDER VARCHAR(10),
        LEND_DATE datetime,
        FINISHED_DATE datetime,
        IS_FINISHED DECIMAL(8,0) DEFAULT 12781002,
        BATCH_NO DECIMAL(4,0),
        D_KEY DECIMAL(1,0) DEFAULT 0,
        CREATED_BY DECIMAL(14,0),
        CREATED_AT datetime,
        UPDATED_BY DECIMAL(14,0),
        UPDATED_AT datetime,
        VER DECIMAL(5,0) DEFAULT 0,
        OTHER_PART_COST_PRICE DECIMAL(12,4),
        OTHER_PART_COST_AMOUNT DECIMAL(12,4),
        DDCN_UPDATE_DATE datetime,
        CONSTRAINT P_P_WORKSHOP_I PRIMARY KEY (ITEM_ID)
    );