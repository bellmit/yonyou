<div class="dms-search">
	<form class="form-horizontal">
		<div class="panel panel-default">
			<div class="panel-body">
				<div class="row ">
					<div class="col-xs-12 col-sm-6 col-md-3">
							<div class="form-group">
								<label class="control-label col-xs-4">装潢订单编号</label>
								<div class="col-xs-8">
									<div class="input-group" data-seledate='true'>
										<input name="soNo" id="soNo" disabled="disabled"
											class="form-control " type="text" />	
										<div class="input-group-btn">
											<button class="btn default btn-sm" type="button" data-Width="modal-lg" data-url="part/basedata/DeckStuff/searchSoNo.html"
												data-toggle="modal" >
												<i class="fa fa-search" />
											</button>
										</div>
									</div>
								</div>	
							</div>
						</div>
					<div class="col-xs-12 col-sm-6 col-md-3 ">
						<div class="form-group form-group-xs m-b-xs">
							<label class="control-label col-xs-4 ">车牌号</label>
							<div class="col-xs-8">
								<input type="text" class="form-control" id="license"
									name="license">
							</div>
						</div>
					</div>
					<div class="col-xs-12 col-sm-6 col-md-3">
						<div class="form-group form-group-xs m-b-xs">
							<label class="control-label col-xs-4 ">客户编号</label>
							<div class="col-xs-8">
								<input type="text" class="form-control" id="customerNo"
									name="customerNo">
							</div>
						</div>
					</div>
					<div class="col-xs-12 col-sm-6 col-md-3">
						<div class="form-group">
							<label class="control-label col-xs-4">装潢专员</label>
							<div class="col-xs-8">
								<select id="serviceAdvisor" name="serviceAdvisor"
									data-fieldName="ZS_MANAGER" class="bs-select form-control"
									data-url="/basedata/employees/-1/salesConsultant"
									data-model="manage" data-labelValue="USER_ID"
									data-lableDesc="USER_NAME">
								</select>
							</div>
						</div>
					</div>
					<div class="col-xs-12 col-sm-6 col-md-3">
						<div class="form-group">
							<label class="control-label col-xs-4">VIN</label>
							<div class="col-xs-8 ">
								<input type="text" class="form-control" id="vin"
									name="vin">
							</div>
						</div>
					</div>
					<div class="col-xs-12 col-sm-6 col-md-3">
						<div class="form-group">
							<label class="control-label col-xs-4">客户名称</label>
							<div class="col-xs-8 ">
								<input type="text" class="form-control" id="customerName" 
									name="customerName">
							</div>
						</div>
					</div>
					<div class="col-xs-12 col-sm-6 col-md-3">
						<div class="form-group">
							<label class="control-label col-xs-4">订单类别</label>
							<div class="col-xs-8">
								<select id="orderSort" name="orderSort"
									data-fieldName="ZS_MANAGER" class="bs-select form-control"
									data-url="/basedata/employees/-1/salesConsultant"
									data-model="manage" data-labelValue="USER_ID"
									data-lableDesc="USER_NAME">
								</select>
							</div>
						</div>
					</div>
					<div class="col-xs-12 col-sm-6 col-md-3">
						<div class="form-group">
							<label class="control-label col-xs-4">车型</label>
							<div class="col-xs-8">
								<select id="model" class="bs-select form-control"
										name="model" data-url="/basedata/selectModel"
										data-model="manage" data-labelValue="MODEL_CODE" data-fieldName="MODEL"
										data-lableDesc="MODEL_NAME" data-alwaysRefresh="true">
								</select>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<div class="panel panel-default table-panel">
			<div class="panel-body">
				<table class="table table-striped table-bordered table-hover table-responsive"
					id="dmstable"></table>
			</div>
			<div class="modal-footer">
				<a class="btn blue" data-beforeRequest="true" data-url="/basedata/BookPartRelease/release" 
					data-model="part" data-method="PUT"
					data-width="modal-lg" data-toggle="confirmation">保存</a>
				<a class="btn blue" data-beforeRequest="true" data-url="/basedata/BookPartRelease/release" 
					data-model="part" data-method="PUT"
					data-width="modal-lg" data-toggle="confirmation">出库</a>
				<a class="btn blue" data-beforeRequest="true" data-url="/basedata/BookPartRelease/release" 
					data-model="part" data-method="PUT"
					data-width="modal-lg" data-toggle="confirmation">取消</a>
				<a class="btn blue" data-beforeRequest="true" data-url="/basedata/BookPartRelease/release" 
					data-model="part" data-method="PUT"
					data-width="modal-lg" data-toggle="confirmation">打印发料单</a> 
			</div>
		</div>
	</form>
</div>

<script type="text/javascript">
	$(document).one("onload.dms",function(event,container){
		new Datatable().initPagination({
			src : "dmstable",
			container:container,
			url : dmsCommon.getDmsPath()["part"] + "/basedata/deckStuff/querydetal",
			rowID : "SO_NO",
			sortName : "", 
			sortOrder : "asc",
			autoHeight : false,
			selectItemName:"itemids",
			isFormParam:true,
			undefinedText : "",
			isQueryFirst : false,
			columns : [ 
				{checkbox:true,sortable : false},
			    {field : "is_Finished",title : "是否入账",inputHiddenFormat:{}}, 
				{field : "so_No",title : "订单编号",inputHiddenFormat:{}},
				{field : "part_No",title : "配件编号",inputHiddenFormat:{}},
				{field : "part_Name",title : "配件名称",inputHiddenFormat:{}}, 
				{field : "storage_Code",title : "仓库",inputHiddenFormat:{}},
				{field : "storage_Position_Code",title : "库位",inputHiddenFormat:{}},
				{field : "unit_Code",title : "单位",inputHiddenFormat:{}}, 
				{field : "discount",title : "折扣率",inputHiddenFormat:{}},
				{field : "PART_COST_AMOUNT",title : "配件成本金额",inputHiddenFormat:{}}, 
				{field : "PART_COST_PRICE",title : "配件成本单价",inputHiddenFormat:{}},
				{field : "part_Sales_Amount",title : "配件实际销售金额",inputHiddenFormat:{}},
				{field : "real_price",title : "实际销售单价",inputHiddenFormat:{hiddenField:"ITEM_ID"}},
				{field : "part_Sales_Price",title : "配件销售单价",inputHiddenFormat:{},dateFormat : {format:"YYYY-MM-DD"} },
				{field : "part_Quantity",title : "配件数量",inputHiddenFormat:{}},
				{field : "USEABLE_STOCK",title : "可用库存 ",inputHiddenFormat:{}},
				{field : "BATCH_NO",title : "流水号 ",inputHiddenFormat:{}},
				{field : "RECEIVER",title : "领料人 ",inputHiddenFormat:{}},
				{field : "sender",title : "发料人 ",inputHiddenFormat:{}},
				{field : "send_Time",title : "发料时间 ",inputHiddenFormat:{}},
				{field : "out_Stock_No",title : "发料单号 ",inputHiddenFormat:{}},
				{field : "part_Batch_No",title : "进货批号 ",inputHiddenFormat:{}},
				{field : "INTERIOR_PRICE",title : "内部核算价 ",inputHiddenFormat:{}},
				{field : "INTERIOR_AMOUNT",title : "内部核算金额 ",inputHiddenFormat:{}}
			]
		});
		
		$("a[data-beforeRequest='true']",container).on("beforeRequest.dms",function(event,returnResult){
			var selectRow1 = $("#dmstable",container).dmsTable().getSelections();
			var selectRow2 = $("#tables",container).dmsTable().getSelections();
			var selectRow3 = $("#stables",container).dmsTable().getSelections();
			var itemid = "";
			$.each(selectRow3,function(index,row){
				console.log(JSON.stringify(row))
				itemid += row.ITEM_ID+",";
			});
			$("#itemid",container).val(itemid.substr(0,itemid.length-1));
			returnResult.status = true;
		});

	});
	
</script>
