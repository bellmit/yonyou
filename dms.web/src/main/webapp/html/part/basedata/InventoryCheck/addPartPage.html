<div class="dms-search">
	<form class="form-horizontal">
		<div class="modal-header">
			<div class="modal-title">配件报溢新增</div>
			<div class="modal-close">
				<a data-dismiss="modal" class="btn btn-lg"> <i
					class="fa fa-remove"></i></a>
			</div>
		</div>
		<div class="modal-body">
			<div class="panel panel-default">
				<div class="panel-body">
					<div class="row">
						<div class="col-xs-12 col-sm-6 col-md-4 col-lg-4">
							<div class="form-group">
								<label class="control-label col-xs-4">仓库</label>
								<div class="col-xs-8">
									<select id="STORAGE_CODE" name="STORAGE_CODE" class="bs-select form-control"
										data-url="/basedata/reportPayOff/findStorageCode" data-model="part"
										data-labelValue="STORAGE_CODE" data-lableDesc="STORAGE_NAME">
									</select>
								</div>
							</div>
						</div>
						<div class="col-xs-12 col-sm-6 col-md-4 col-lg-4">
							<div class="form-group">
								<label class="control-label col-xs-4">品牌</label>
								<div class="col-xs-8">
									<select id="brand" class="bs-select form-control"
										name="BRAND" data-url="/basedata/brandsdict2"
										data-model="manage" data-labelValue="BRAND_CODE"
										data-lableDesc="BRAND_NAME">
									</select>
								</div>
							</div>
						</div>
						<div class="col-xs-12 col-sm-6 col-md-4 col-lg-4">
							<div class="form-group">
								<label class="control-label col-xs-4">配件代码</label>
								<div class="col-xs-8">
									<input id="PART_NO" name="PART_NO"
										class="form-control" type="text" />
								</div>
							</div>
						</div>

						<div class="col-xs-12 col-sm-6 col-md-4 col-lg-4">
							<div class="form-group">
								<label class="control-label col-xs-4 ">拼音</label>
								<div class="col-xs-8">
									<input id="SPELL_CODE" name="SPELL_CODE"
										class="form-control" type="text" />
										<input id="stockQuantity" name="stockQuantity" class="form-control" type="hidden"/>
								</div>
							</div>
						</div>
						<div class="col-xs-12 col-sm-6 col-md-4 col-lg-4">
							<div class="form-group">
								<label class="control-label col-xs-4 ">名称</label>
								<div class="col-xs-8">
									<input id="PART_NAME" name="PART_NAME" class="form-control" type="text" />
								</div>
							</div>
						</div>
						<div class="col-xs-12 col-sm-6 col-md-4 col-lg-4">
							<div class="form-group">
								<label class="control-label col-xs-4">类别</label>
								<div class="col-xs-8">
									<select class="bs-select form-control" id="PART_GROUP_CODE"
									name="PART_GROUP_CODE" data-dictCode="1136">
									</select>
								</div>
							</div>
						</div>
						<div class="col-xs-12 col-sm-6 col-md-4 col-lg-4">
							<div class="form-group">
								<label class="control-label col-xs-4 ">库位</label>
								<div class="col-xs-8">
									<input id="STORAGE_POSITION_CODE" name="STORAGE_POSITION_CODE" class="form-control" type="text" />
								</div>
							</div>
						</div>
						<div class="col-xs-12 col-sm-6 col-md-4 col-lg-4">
							<div class="form-group">
								<label class="control-label col-xs-4">车型组</label>
								<div class="col-xs-8">
									<select id="PART_MODEL_GROUP_CODE_SET" class="bs-select form-control"
										name="PART_MODEL_GROUP_CODE_SET" data-url="/basedata/reportPayOff/findPartModelGroup"
										data-model="part" data-labelValue="PART_MODEL_GROUP_CODE"
										data-lableDesc="PART_MODEL_GROUP_NAME">
									</select>
								</div>
							</div>
						</div>
					</div>
					<div class="row">
						<div class="col-xs-12 ">
							<div class="query-btn">
								<a href="javascript:;" class="btn blue"> <i
									class="fa fa-search"></i>查询
								</a> 
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="panel panel-default table-panel">
				<div class="panel-body">
					<table
						class="table table-striped table-bordered table-hover table-responsive"
						id="partInfoTable">
					</table>
				</div>
			</div>
		</div>
		<div class="modal-footer center-block">
			<a   id="save" data-callBack="true" data-onclickEvent='true' class="btn blue"
				><i class="fa fa-save"></i>确定</a> <a
				data-dismiss="modal" class="btn blue"><i
				class="fa fa-undo"></i>取消</a>
		</div>
	</form>
</div>
<script type="text/javascript">
$(document).one("onload.dms",function(event,container){
	new Datatable().initPagination({
		src : "partInfoTable",
		container:container,
		rowID:"PART_NO",
		url : dmsCommon.getDmsPath()["part"] + "/basedata/reportPayOff/findPartForAdd", 
		sortOrder : "asc",
		//isQueryFirst:false,
		autoHeight:false,
		columns : [ 
			{radio : true,sortable : false},
            {field : "STORAGE_NAME",title : "仓库",inputHiddenFormat : {hiddenField:"STORAGE_CODE"}},
            {field : "STORAGE_POSITION_CODE",title : "库位",inputHiddenFormat : {}},
            {field : "PART_NO",title : "配件代码",inputHiddenFormat : {}},
            {field : "PART_NAME",title : "配件名称",inputHiddenFormat : {}},
            {field : "PART_MODEL_GROUP_CODE_SET",title : "车型组集"},
            {field : "PART_BATCH_NO",title : "进货批号",inputHiddenFormat : {}},
            {field : "SALES_PRICE",title : "销售价",inputHiddenFormat : {},numberFormat : {decimal : 2}},
            {field : "COST_PRICE",title : "成本价",inputHiddenFormat : {},numberFormat : {decimal : 2}},
            {field : "STOCK_QUANTITY",title : "账面库存",inputHiddenFormat : {},numberFormat : {decimal : 2}},
            {field : "BORROW_QUANTITY",title : "借进数量",inputHiddenFormat : {},numberFormat : {decimal : 2}},
            {field : "LEND_QUANTITY",title : "借出数量",inputHiddenFormat : {},numberFormat : {decimal : 2}},
            {field : "REMARK",title : "备注",inputHiddenFormat : {}}
         ]
	});
	
	$("a[data-onclickEvent='true']",container).on("dms.click",function(event){
		var selectRow = $("#partInfoTable",container).dmsTable().getSelections();
		selectRow[0].CURRENT_STOCK=selectRow[0].STOCK_QUANTITY;//给前页面当前库存赋值
		selectRow[0].REAL_STOCK=parseFloat(selectRow[0].STOCK_QUANTITY)+parseFloat(selectRow[0].BORROW_QUANTITY)-parseFloat(selectRow[0].LEND_QUANTITY);
		$("#dms_details",getElementContext()).dmsTable().appendRow(selectRow[0]);
		$("a[data-dismiss='modal']",container).click();
	});
	
});
</script>