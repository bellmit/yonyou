<div class="dms-edit ajaxrest">
	<form class="form-horizontal" id="myform">
		<div class="panel panel-default">
			<div class="modal-body">
				<div class="row " data-tableSelect="true">

					<div class="col-xs-12 col-sm-6 col-md-4 col-lg-3">
						<div class="form-group">
							<label class="control-label col-xs-4">工单号</label>
							<div class="col-xs-8 ">
								<div class="input-group">
					                 	<input id="roNo" name="roNo" class="form-control"
									type="text" data-fieldName="RO_NO" data-Change="true" readonly data-isExcludeReadOnly="true"/>
										 <span class="input-group-btn">
										<button class="btn default btn-sm" type="button"
											id="deliveryNo1"
											data-url="part/partOrder/partPric/selectRepairOrder.html"
											data-toggle="modal" data-width="modal-lg">
											<i class="fa fa-list-alt"></i>
										</button>
										<button class="btn default input-clear" type="button" data-onclickEvent1="true"
											id="deliveryNo1">
											<i class="fa fa-close"></i>
										</button>
									</span>
								</div>
							</div>
						</div>
					</div>
					<!--/span-->
					<div class="col-xs-12 col-sm-6 col-md-4 col-lg-3">
						<div class="form-group">
							<label class="control-label col-xs-4 ">车牌号</label>
							<div class="col-xs-8">
								<input id="license" name="license" class="form-control"
									type="text" data-fieldName="LICENSE" data-Change="true" />
							</div>
						</div>
					</div>
					<!--/span-->
					<div class="col-xs-12 col-sm-6 col-md-4 col-lg-3">
						<div class="form-group">
							<label class="control-label col-xs-4">工单类型</label>
							<div class="col-xs-8">
								<select id="orderType" name="orderType"
									data-fieldName="RO_TYPE"
									class="bs-select form-control " data-dictCode="1253"
									data-excludeItems="12531003" >
								</select>
							</div>
						</div>
					</div>
					<!--/span-->
					<div class="col-xs-12 col-sm-6 col-md-4 col-lg-3">
						<div class="form-group">
							<label class="control-label col-xs-4">维修类型</label>
							<div class="col-xs-8">
								<select id="repairTypeCode" name="repairTypeCode"
									class="bs-select form-control"
									data-url="/basedata/repairtypes/getRepairTypes/item"
									data-model="manage" data-labelValue="REPAIR_TYPE_CODE"
									data-lableDesc="REPAIR_TYPE_NAME" data-fieldName="REPAIR_TYPE_CODE">
								</select>
							</div>
						</div>
					</div>
					<!--/span-->
					<div class="col-xs-12 col-sm-6 col-md-4 col-lg-3">
						<div class="form-group">
							<label class="control-label col-xs-4">车型</label>
							<div class="col-xs-8">
								<select id="model" class="bs-select form-control"
									name="modelCode" data-url="/basedata/selectModel"
									data-model="manage" data-labelValue="MODEL_CODE" data-fieldName="MODEL"
									data-lableDesc="MODEL_NAME" data-alwaysRefresh="true">
								</select>
							</div>
						</div>
					</div>
					<!--/span-->
					<div class="col-xs-12 col-sm-6 col-md-4 col-lg-3">
						<div class="form-group">
							<label class="control-label col-xs-4">开单日期</label>
							<div class="col-xs-8">
								<div class="input-group date date-picker">
									<input id="deInDate" name="deInDate" readonly
										class="form-control" type="text" value=""
										data-fieldName="RO_CREATE_DATE" /> <span
										class="input-group-btn">
										<button class="btn default date-set" type="button">
											<i class="fa fa-calendar"></i>
										</button>
										<button class="btn default date-reset" type="button">
											<i class="fa fa-times"></i>
										</button>
									</span>

								</div>
							</div>
						</div>
					</div>

					<!--/span-->
					<div class="col-xs-12 col-sm-6 col-md-4 col-lg-3">
						<div class="form-group">
							<label class="control-label col-xs-4 ">车主</label>
							<div class="col-xs-8">
								<input id="ownerName" name="ownerName" class="form-control"
									type="text" data-fieldName="OWNER_NAME" data-Change="true" />
							</div>
						</div>
					</div>
					<!--/span-->
					<div class="col-xs-12 col-sm-6 col-md-4 col-lg-3">
						<div class="form-group" data-campaignSelect="true">
							<label class="control-label col-xs-4">指定技师</label>
							<div class="col-xs-8">
								<select id="chieftechnician" name="chieftechnician"
									data-fieldName="CHIEF_TECHNICIAN"
									class="bs-select form-control"
									data-url="/basedata/employees/queryTechnician/dicts"
									data-model="manage" data-labelValue="USER_CODE"
									data-value="{[userInfo.userId]}" data-lableDesc="USER_NAME">
								</select>
							</div>
						</div>
					</div>




				</div>
				<div class="row hidden">
					<div class="col-xs-12 ">
						<div class="query-btn">
							<a href="javascript:;" class="btn blue" data-onclickEvent="true" data-errorCallBack="true"> <i
								class="fa fa-search" ></i> 查询
							</a> 
						
						</div>
					</div>
				</div>

			</div>
		</div>
		<div class="panel panel-default table-panel">

			<div class="panel-body">
				<table
					class="table table-striped table-bordered table-hover table-responsive"
					id="partSendPrice">
				</table>

			</div>
		</div>
		<div class="form-actions">
			<a data-url="/partOrder/stuffPriceAdjust/changePartSendPrice" data-model="part" data-method="PUT" data-callBack="true"  
			   class="btn blue" data-toggle="confirmation" data-isExcludeReadOnly="true" data-beforeRequest="true" ><i class="fa fa-save"></i>保存</a>
			<a data-goback="page"  href="part/partOrder/partPric/InfoDMSWithDrawStuffPriceAdjust.html"   class="btn blue ajaxify">
			<i class="fa fa-reply"></i>取消</a>
		</div>
	</form>

</div>
<script type="text/javascript">
$(document).one("onload.dms",function(event,container){
 	new Datatable().initLocale({
		src : "partSendPrice",
		container:container,
	  //  url : dmsCommon.getDmsPath()["part"] + "/partOrder/stuffPriceAdjust/RO1604150002/queryPartSendPrice",
		rowID : "ITEM_ID",
		autoHeight:false,
		selectItemName:"itemId",
		columns : [
		            {field : "STORAGE_CODE",title : "仓库",inputField:"storageCode",inputHiddenFormat:{}},
		            {field : "STORAGE_POSITION_CODE",title : "库位"},
		            {field : "IS_MAIN_PART",title : "主要配件",codeFormat : {type:"dict",codeType:"1278"}},
		            {field : "PART_NO",title : "配件代码",inputHiddenFormat:{hiddenFieldName:"partNo,itemId",hiddenField:"PART_NO,ITEM_ID"}},
		            {field : "PART_NAME",inputField:"partName",title : "配件名称",inputHiddenFormat:{}},
		            {field : "PART_COST_PRICE",inputField:"costPrice",title : "成本价"},
		            {field : "PART_COST_PRICE_AT",title : "含税成本价"},
		            {field : "UNIT_CODE",title : "计量单位"},
		            {field : "PART_QUANTITY",title : "数量",inputField:"partQuantity",inputHiddenFormat:{}},
					{ field :"PART_SALES_PRICE", inputField :"partSalesPrice", title :"<span style='color: blue;'>配件销售单价</span>", inputNumberFormat : {validate:{validateClass:"required decimal",validateAttr:'maxDigit="10" maxPrecision="4"'}}, inputHiddenFormat : {}},
					{field : "PART_SALES_AMOUNT", inputField :"partSalesAmount", title :"金额", inputHiddenFormat : {}, numberFormat:{decimal : 2,validate:{validateClass:" money",validateAttr:'maxDigit="16" maxPrecision="2"'},autoValueFormat:{autoValue:"#partSalesPrice*#partQuantity"}}},
		            {field : "CHARGE_PARTITION_CODE",title : "收费区分"},
		            {field : "RECEIVER",title : "领料人"},
		            {field : "BATCH_NO",title : "流水号",inputHiddenFormat : {hiddenFieldName:"batchNo,partBatchNo",hiddenField:"BATCH_NO,PART_BATCH_NO"}},
		            {field : "OLD_PRICE",title : "原单价",inputField:"oldPrice",inputHiddenFormat:{}},
		            {field : "IS_DISCOUNT",title : "不可打折",codeFormat : {type:"dict",codeType:"1278"}},
		            {field : "LIMIT_PRICE",title : "销售限价",inputField:"limitPrice",inputHiddenFormat:{}}
		         ]
	});


	$("a[data-callBack='true']",container).on("callBack.dms",function(event,value){
		$("#partSendPrice",container).dmsTable().refreshTableWithForm();
	})
	
	$("a[data-errorCallBack='true']",container).on("errorCallBack.dms",function(event,response){
		$(':input','#myform')  
		 .not(':button, :submit, :reset, :hidden')  
		 .val('')
		 .selectpicker('val','')
		 .removeAttr('checked')  
		 .removeAttr('selected');
	});
	

	$("button[data-onclickEvent1='true']",container).on("dms.click",function(event){
		$("#partSendPrice",container).bootstrapTable("removeAll");
		$(':input','#myform')  
		 .not(':button, :submit, :reset, :hidden')  
		 .val('')
		 .selectpicker('val','')
		 .removeAttr('checked')  
		 .removeAttr('selected');
	});
	$("a[data-beforeRequest='true']",container).on("beforeRequest.dms",function(event,returnResult){
		var roNo=$("#roNo",container).val();
		if(isStringNull(roNo)){
			returnResult.status = false;
			return ;
		}
	
		returnResult.status = true;
	});
	dmsPart.initElementReadOnly(container);

});		
</script>