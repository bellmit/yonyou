<div class="dms-search">
	<form class="form-horizontal">
		<div class="panel panel-default">
			<div class="panel-body">
				<div class="row ">
					<div class="col-xs-12 col-sm-6 col-md-4 col-lg-3 "
						data-tableSelect="true">
						<div class="form-group">
							<label class="control-label col-xs-4">经销商代码</label>
							<div class="col-xs-8">
								<div class="input-group">
									<input id="dealerCode" readonly name="dealerCode"
										class="form-control" type="text" data-fieldName="dealer_code" />
									<span class="input-group-btn">
										<button class="btn default btn-sm" type="button"
											data-url="manage/basedata/dealers/searchDealers.html"
											data-toggle="modal" data-width="modal-lg">
											<i class="fa fa-list-alt"></i>
										</button>
										<button class="btn default input-clear" type="button">
											<i class="fa fa-close"></i>
										</button>
									</span>
								</div>
							</div>
						</div>
					</div>
					<div class="col-xs-12 col-sm-6 col-md-4 col-lg-3">
						<div class="form-group">
							<label class="control-label col-xs-4">物料类型</label>
							<div class="col-xs-8">
								<select id="groupType" name="groupType"
									class="bs-select form-control" data-type="oemDict"
									data-dictCode="9008">
								</select>
							</div>
						</div>
					</div>
					<div class="col-xs-12 col-sm-6 col-md-4 col-lg-3 ">
						<div class="form-group">
							<label class="control-label col-xs-4">品牌</label>
							<div class="col-xs-8">
								<select id="brandId" parent="groupType" class="bs-select form-control"
									name="brandCode" data-url="/basedata/material/brand/{[groupType]}"
									data-model="manage" data-labelValue="BRAND_ID"
									data-lableDesc="BRAND_NAME">
								</select>

							</div>
						</div>
					</div>
					<div class="col-xs-12 col-sm-6 col-md-4 col-lg-3 ">
						<div class="form-group">
							<label class="control-label col-xs-4">车系</label>
							<div class="col-xs-8">
								<select id="seriesId" parent="brandId"
									class="bs-select form-control" name="seriesName"
									data-url="/basedata/material/series/{[groupType]}/{[brandId]}"
									data-model="manage" data-labelValue="SERIES_ID"
									data-lableDesc="SERIES_NAME">
								</select>
							</div>
						</div>
					</div>
					<div class="col-xs-12 col-sm-6 col-md-4 col-lg-3 ">
						<div class="form-group">
							<label class="control-label col-xs-4">车款</label>
							<div class="col-xs-8">
								<select id="groupId" parent="seriesId"
									class="bs-select form-control" name="groupName"
									data-url="/basedata/material/group/{[groupType]}/{[seriesId]}"
									data-model="manage" data-labelValue="GROUP_ID"
									data-lableDesc="GROUP_NAME">
								</select>
							</div>
						</div>
					</div>
					<div class="col-xs-12 col-sm-6 col-md-4 col-lg-3 ">
						<div class="form-group">
							<label class="control-label col-xs-4">年款</label>
							<div class="col-xs-8">
								<select id="modelId" parent="groupId"
									class="bs-select form-control" name="modelYear"
									data-url="/basedata/material/modelYear/{[groupType]}/{[groupId]}"
									data-model="manage" data-labelValue="MODEL_YEAR"
									data-lableDesc="MODEL_YEAR">
								</select>
							</div>
						</div>
					</div>
					<div class="col-xs-12 col-sm-6 col-md-4 col-lg-3 ">
						<div class="form-group">
							<label class="control-label col-xs-4">颜色</label>
							<div class="col-xs-8">
								<select id="colorId" parent="modelId"
									class="bs-select form-control" name="colorName"
									data-url="/basedata/material/color/{[groupType]}/{[groupId]}/{[modelId]}"
									data-model="manage" data-labelValue="COLOR_CODE"
									data-lableDesc="COLOR_NAME">
								</select>
							</div>
						</div>
					</div>
					<div class="col-xs-12 col-sm-6 col-md-4 col-lg-3 ">
						<div class="form-group">
							<label class="control-label col-xs-4">内饰</label>
							<div class="col-xs-8">
								<select id="trimId" parent="colorId"
									class="bs-select form-control" name="trimName"
									data-url="/basedata/material/trim/{[groupType]}/{[groupId]}/{[modelId]}/{[colorId]}"
									data-model="manage" data-labelValue="TRIM_CODE"
									data-lableDesc="TRIM_NAME">
								</select>
							</div>
						</div>
					</div>
					<div class="col-xs-12 col-sm-6 col-md-4 col-lg-3 ">
						<div class="form-group">
							<label class="control-label col-xs-4">是否交车</label>
							<div class="col-xs-8">
								<select id="nvdr" name="nvdr" class="bs-select form-control"
									data-type="oemDict" data-dictCode="1004">
								</select>
							</div>
						</div>
					</div>
					<div class="col-xs-12 col-sm-6 col-md-4 col-lg-3 ">
						<div class="form-group">
							<label class="control-label col-xs-4 ">VIN</label>
							<div class="col-xs-8">
								<textarea class="form-control" id="vin" name="vin" rows="2"></textarea> 
							</div>
						</div>
					</div>
				</div>
				<div class="row ">
					<div class="modal-footer center-block">
						<a href="javascript:;" class="btn blue" data-onclickEvent="true"
							id="conutquery"> <i class="fa fa-search"></i> 汇总查询 </a>
						<a href="javascript:;" class="btn blue" data-onclickEvent="true"
							id="conutdetailquery"> <i class="fa fa-search"></i> 明细查询 </a>
						<div  class="query-btn" style="display: inline; margin-bottom:5px; margin-left:5px;" >
							<a class="btn blue " ><i class="fa fa-undo"></i>重置 </a>
						</div>
					</div>
				</div>
				<div class="panel panel-default table-panel" id="countId">
					<div class="panel-heading">
						<div class="pannel-name">库存管理汇总查询信息</div>
						<div class="pannel-button">
							<div class="btn-group btn-group-sm">
								<a href="javascript:;"
									data-url="/inventoryQuery/export/excel/group"
									data-model="vehicle" data-method="downLoad"
									data-toggle="confirmation" class="btn btn-outline "><i
									class="fa fa-download"></i>汇总下载</a>
							</div>
						</div>
					</div>
					<div class="panel-body">
						<table
							class="table table-striped table-bordered table-hover table-responsive"
							id="forecastQueryTotal_table"></table>
					</div>
				</div>
				<div class="panel panel-default table-panel hidden" id="detailId">
					<div class="panel-heading">
						<div class="pannel-name">库存管理明细查询信息</div>
						<div class="pannel-button">
							<div class="btn-group btn-group-sm">
								<a href="javascript:;"
									data-url="/inventoryQuery/export/excel/detail"
									data-model="vehicle" data-method="downLoad"
									data-toggle="confirmation" class="btn btn-outline "><i
									class="fa fa-download"></i>明细下载</a>
							</div>
						</div>
					</div>
					<div class="panel-body">
						<table
							class="table table-striped table-bordered table-hover table-responsive"
							id="forecastQueryDetail_table"></table>
					</div>
				</div>
			</div>
		</div>
	</form>


</div>
<script type="text/javascript">
	$(document).one(
			"onload.dms",
			function(event, container) {
				//汇总查询
				new Datatable().initPagination({
					src : "forecastQueryTotal_table",
					container : container,
					url : dmsCommon.getDmsPath()["vehicle"]
							+ "/inventoryQuery/groupQuery",
					rowID : "",
					autoHeight : false,
					isQueryFirst : false,
					columns : [ {
						field : "DEALER_CODE",
						title : "经销商代码"
					}, {
						field : "DEALER_NAME",
						title : "经销商名称"
					}, {
						field : "VIN",
						title : "库存数量"
					} ],
					onLoadSuccess : function() {
						$("#forecastQueryTotal_table", container).dmsTable()
								.bootstrapTable('resetView');
					}
				});

				//明细查询
				new Datatable().initPagination({
					src : "forecastQueryDetail_table",
					container : container,
					rowID : "",
					url : dmsCommon.getDmsPath()["vehicle"]
							+ "/inventoryQuery/detailQuery",
					autoHeight : false,
					isQueryFirst : false,
					columns : [ {
						field : "DEALER_CODE",
						title : "经销商代码"
					}, {
						field : "DEALER_SHORTNAME",
						title : "经销商名称"
					}, {
						field : "BRAND_NAME",
						title : "品牌"
					}, {
						field : "SERIES_NAME",
						title : "车系"
					}, {
						field : "MODEL_CODE",
						title : "CPOS"
					}, {
						field : "GROUP_NAME",
						title : "车款"
					}, {
						field : "MODEL_YEAR",
						title : "年款"
					}, {
						field : "COLOR_NAME",
						title : "颜色"
					}, {
						field : "TRIM_NAME",
						title : "内饰"
					}, {
						field : "VIN",
						title : "VIN"
					}, {
						field : "NODE_STATUS",
						title : "车辆节点状态",
						codeFormat : {
							type : "oemDict",
							codeType : "1151"
						}
					}, {
						field : "LIFE_CYCLE",
						title : "车辆库存状态",
						codeFormat : {
							type : "oemDict",
							codeType : "1152"
						}
					}, {
						field : "YOUI_DATE",
						title : "开票日期"
					}, {
						field : "ZVHC_DATE",
						title : "发运日期"
					}, {
						field : "ZPD2_DATE",
						title : "到店日期"
					}, {
						field : "DEALER_STORAGE_DATE",
						title : "验收日期"
					}, {
						field : "CREATE_DATE",
						title : "零售上报日期"
					}, {
						field : "NVDR_DATE",
						title : "零售上报审核日期"
					}, {
						field : "NVDR",
						title : "是否交车"
					} ],
					onLoadSuccess : function() {
						$("#forecastQueryDetail_table", container).dmsTable()
								.bootstrapTable('resetView');
					}
				});

				//绑定汇总查询按钮回调
				$("#conutquery[data-onclickEvent='true']", container).on(
						"dms.click",
						function(event) {
							$("#countId", container).removeClass("hidden");
							$("#detailId", container).addClass("hidden");
							$("#forecastQueryTotal_table", container)
									.dmsTable().refreshTableWithForm();

						});

				//绑定明细查询按钮回调
				$("#conutdetailquery[data-onclickEvent='true']", container).on(
						"dms.click",
						function(event) {
							$("#detailId", container).removeClass("hidden");
							$("#countId", container).addClass("hidden");
							$("#forecastQueryDetail_table", container)
									.dmsTable().refreshTableWithForm();
						});

			});
</script>
