<div class="dms-search">
	<form class="form-horizontal">
	
			<div class="panel panel-default">
		       <div class="panel-heading">
								<div class="pannel-name">查询条件</div>
								<div class="pannel-tools">
									<a href="javascript:;" class=collapse> <i
										class="fa fa-chevron-down"></i></a>
								</div>
			    </div>
			<div class="panel-body">
				<div class="row ">

				<div class="col-xs-12 col-sm-12 col-md-8 col-lg-6">
						<div class="form-group">
							<label class="control-label col-xs-4 col-sm-2">更新日期区间</label>
							<div class="col-xs-8 col-sm-10">
								<div class="input-group input-daterange">
									<input type="text" class="form-control" name="startDate" id="startDate" disabled="disabled">
									<span class="input-group-addon">至</span> <input type="text" class="form-control"
										name="endDate" id="endDate" disabled="disabled"> <span class="input-group-btn">
										<button class="btn default input-clear" type="button">
											<i class="fa fa-close"></i>
										</button>
									</span>
								</div>
							</div>
						</div>
					</div>								

				</div>			
			</div>
			<div class="row ">

					<div class="col-xs-12 col-sm-6 col-md-4 col-lg-3">
						<div class="form-group">
							<label class="control-label col-xs-4">项目车型组</label>
							<div class="col-xs-8">
								<select id="modelLabourCode" class="bs-select form-control" name="modelLabourCode"
									data-url="/decrodateProject/duty/dicts" data-model="vehicle"
									data-labelValue="MODEL_LABOUR_CODE" data-lableDesc="MODEL_LABOUR_NAME" multiple
									data-live-search="true" data-size="4" data-existsDefault="false">
								</select>
							</div>
						</div>
					</div>
					
					<div class="col-xs-12 col-sm-6 col-md-4 col-lg-3">
						<div class="form-group">
							<label class="control-label col-xs-4 ">对应车型</label>
							<div class="col-xs-8">
								<input type="text" class="form-control" id="" name="">
							</div>
						</div>
					</div>

					<div class="col-xs-12 col-sm-6 col-md-4 col-lg-3">
						<div class="form-group">
							<label class="control-label col-xs-4">是否下发</label>
							<div class="col-xs-8">
								<select id="downTag" name="downTag" class="bs-select form-control" data-dictCode="1278">
								</select>
							</div>
						</div>
					</div>

					<div class="col-xs-12 col-sm-6 col-md-4 col-lg-3">
						<div class="form-group">
							<label class="control-label col-xs-4 ">装潢项目名称</label>
							<div class="col-xs-8">
								<input type="text" class="form-control" id="labourName" name="labourName">
							</div>
						</div>
					</div>

					<div class="col-xs-12 col-sm-6 col-md-4 col-lg-3">
						<div class="form-group">
							<label class="control-label col-xs-4 ">装潢项目代码</label>
							<div class="col-xs-8">
								<input type="text" class="form-control" id="labourCode" name="labourCode">
							</div>
						</div>
					</div>

					<div class="col-xs-12 col-sm-6 col-md-4 col-lg-3">
						<div class="form-group">
							<label class="control-label col-xs-4 ">装潢项目拼音</label>
							<div class="col-xs-8">
								<input type="text" class="form-control" id="spellCode" name="spellCode">
							</div>
						</div>
					</div>

					<div class="col-xs-12 col-sm-6 col-md-4 col-lg-3">
						<div class="form-group">
							<label class="control-label col-xs-4">主分类名称</label>
							<div class="col-xs-8">
								<select id="mainGroupCode" class="bs-select form-control" name="mainGroupCode"
									data-url="/decrodateProject/duty/main" data-model="vehicle"
									data-labelValue="MAIN_GROUP_CODE" data-lableDesc="MAIN_GROUP_NAME">
								</select>
							</div>
						</div>
					</div>

					<div class="col-xs-12 col-sm-6 col-md-4 col-lg-3">
						<div class="form-group">
							<label class="control-label col-xs-4">二级分类名称</label>
							<div class="col-xs-8">
								<select id="subGroupCode" parent="mainGroupCode" class="bs-select form-control"
									name="subGroupCode" data-url="/decrodateProject/{[mainGroupCode]}/sub" data-model="vehicle"
									data-labelValue="MAIN_GROUP_CODE" data-lableDesc="SUB_GROUP_NAME">
								</select>
							</div>
						</div>
					</div>

					<div class="col-xs-12 col-sm-6 col-md-4 col-lg-3">
						<div class="form-group">
							<label class="control-label col-xs-4 ">行管项目代码</label>
							<div class="col-xs-8">
								<input type="text" class="form-control" id="localLabourCode" name="localLabourCode">
							</div>
						</div>
					</div>

					<div class="col-xs-12 col-sm-6 col-md-4 col-lg-3">
						<div class="form-group">
							<label class="control-label col-xs-4 ">行管项目名称</label>
							<div class="col-xs-8">
								<input type="text" class="form-control" id="localLabourName" name="localLabourName">
							</div>
						</div>
					</div>

					<div class="col-xs-12 col-sm-6 col-md-4 col-lg-3">
						<div class="form-group">
							<label class="control-label col-xs-4">工种</label>
							<div class="col-xs-8">
								<select id="workerTypeCode" class="bs-select form-control" name="workerTypeCode"
									data-url="/decrodateProject/duty/work" data-model="vehicle"
									data-labelValue="WORKER_TYPE_CODE" data-lableDesc="WORKER_TYPE_NAME">
								</select>
							</div>
						</div>
					</div>

					<div class="col-xs-12 col-sm-6 col-md-4 col-lg-3">
						<div class="form-group">
							<label class="control-label col-xs-4">标准工时为空</label>
							<div class="col-xs-8">
								<select id="nullLabour" name="nullLabour" class="bs-select form-control" data-dictCode="1278">
								</select>
							</div>
						</div>
					</div>
			
			</div>
			
				<div class="row ">
					<div class="col-xs-12 ">
						<div class="query-btn">
							<a href="javascript:;" class="btn blue" id="search"> <i
								class="fa fa-search"></i> 查询
							</a> <a href="javascript:;" class="btn blue"><i
								class="fa fa-undo"></i> 重置</a>							
						</div>
					</div>
				</div>
				
			<div class="row" class="tree">
				<div class="panel-heading">
					<div class="pannel-name">装潢项目列表</div>
						<div class="pannel-button">
							<div class="btn-group btn-group-sm">
								<a class="btn btn-outline" id = "add"
									data-url="vehicle/decrodateProjectManageEx/addDecrodate.html" data-beforeShowEvent="true" 
									data-toggle="modal" data-width="modal-lg"> <i
									class="fa fa-plus-square"></i> 新增
								</a>
								
								<a class="btn btn-outline"  id = "copy"
									data-url="vehicle/decrodateProjectManageEx/copyAll.html" data-beforeShowEvent="true" 
									data-toggle="modal" data-width="modal-sm"> <i
									class="fa fa-plus-square"></i>全部复制
								</a>
								
								<a data-url="/decrodateProject/export/excel"
									data-model="vehicle" data-method="downLoad"
									data-toggle="confirmation" class="btn btn-outline "><i class="fa fa-download"></i>导出
								</a> 
								
								<a href="vehicle/decrodateProjectManageEx/importDecrodate.html" class="btn btn-outline ajaxify"> <i
									class="fa fa-upload"></i>导入
								</a> 
								
								<a href="javascript:;" data-url="/basedata/download/template/decrodateTemplate" data-model="web" data-method="downLoad"
									class="btn btn-outline ajaxrest" data-validate = "false" ><i class="fa fa-plus-square"></i>模板导出</a>
							</div>
						</div>
				</div>
<!-- 				<div class="panel-body col-sm-3 col-xs-12" style="border:solid 1px #DDDDDD;height:400px;overflow:scroll;">
			           <div id="vehicleTree" name="vehicleTree" class="tree"></div> 
           				<div id="vehicleTreeCheckValid" name="vehicleTree" class="tree"></div>
				</div>
				<div class="panel-body col-sm-9 col-xs-12" style="border:solid 1px #DDDDDD;height:400px;overflow:scroll;">
						<table class="table table-striped table-bordered table-hover table-responsive"
							id="dms_table">
						</table>
				</div> -->
				
			<div class="row" class="tree">
				<div id="vehicleTree" class="col-xs-8 col-md-4"></div>
				<input type="hidden" name="code" id="code"> 
				<div class="col-xs-8 col-md-8">
					<table class="table table-striped table-bordered table-hover table-responsive"
						id="dms_table">
					</table>
				</div> 					
			</div>
				
				
			
			</div>
		</div>
	</form>
	
</div>
<script type="text/javascript">
$(document).one("onload.dms",function(event,container){
	
	//树节点选择	
	$('#vehicleTree',container).on('changed.jstree', function (e, data) {
		var node = data.changed.selected;
		if(node!=""){
			$("#code",container).val(node);
			$("#dms_table",getElementContext()).dmsTable().refreshTableWithForm();
		} 
	});

	new Datatable().initPagination({
		src : "dms_table",
		container:container,
		url : dmsCommon.getDmsPath()["vehicle"] + "/decrodateProject",
			rowID : "CREATED_AT",
			sortName : "CREATED_AT",
			sortOrder : "asc",
			autoHeight: false,
			undefinedText : "",
			
			columns : [ 
				{radio:true,sortable : false},
				{field : "MODEL_LABOUR_CODE",title : "操作",operateFormat : [
					 {type:"edit",url:"vehicle/decrodateProjectManageEx/editDecrodate.html",openWidth:"modal-lg"},
					 {type:"edit",url:"vehicle/decrodateProjectManageEx/copyOne.html",operateIcon:'<i class="fa fa-lg fa-copy"></i>',title:'单项复制',openWidth:"modal-lg"}
					]}, 
				 {field : "MODEL_LABOUR_CODE",title : "装潢车型分组代码"},
             	 {field : "LABOUR_CODE",title : "装潢项目代码"},
		         {field : "LABOUR_NAME",title : "装潢项目名称"},
		         {field : "REPAIR_TYPE_CODE",title : "装潢类型"},
		         {field : "LOCAL_LABOUR_CODE",title : "行管项目代码"},
		         {field : "LOCAL_LABOUR_NAME",title : "行管项目名称"},
		         {field : "STD_LABOUR_HOUR",title : "标准工时"},
		         {field : "ASSIGN_LABOUR_HOUR",title : "派工工时"},
		         {field : "WORKER_TYPE_NAME",title : "工种"},
		         {field : "OPERATION_CODE",title : "索赔项目代码"},
		         {field : "CLAIM_LABOUR",title : "索赔工时"},
		         {field : "SPELL_CODE",title : "拼音代码"},
		         {field : "REPAIR_GROUP_CODE",title : "装潢项目分组代码"},
		         {field : "OEM_LABOUR_HOUR",title : "OEM标准工时"},
		         {field : "DOWN_TAG",title : "是否下发" ,codeFormat : {type:"dict",codeType:"1278"}},
		         {field : "CREATED_AT",title : "创建日期",dateFormat : {format:"YYYY-MM-DD HH:mm:ss"}},
		         {field : "UPDATED_AT",title : "更新日期",dateFormat : {format:"YYYY-MM-DD HH:mm:ss"}},
		         {field : "IS_MEMBER",title : "是否会员专用",codeFormat : {type:"dict",codeType:"1278"}},	
		         {field : "REPLACE_STATUS",title : "更新状态" ,codeFormat : {type:"dict",codeType:"1278"}}
		       
		  
			],
			onLoadSuccess : function() {
				var rownu = $("#dms_table",container).dmsTable().getTableRows();
				if(rownu<=0){
					$("a[data-method='downLoad']",container).attr("disabled","true");
				}else{
					$("a[data-method='downLoad']",container).removeAttr("disabled");
				}
			}
		});
	
	
	
	//弹出页面打开前执行函数
	$("a[data-beforeShowEvent='true']", container).on("beforeShow.dms",function(event, returnResult) {
				var selectRow = $("#dms_table", container).dmsTable().getSelections();
				var falg = true;
				if (!selectRow) {
					dmsCommon.tip({status : "warning",msg : "请选择表格数据"});
					returnResult.status = false;
					return;
				}
				if (!falg) {
					returnResult.status = false;
					return;
				}
				returnResult.status = true;
			});

  		loadTree("vehicleTree",container);		
	 	$("a[data-onclickEvent='true']",container).on("dms.click",function(event,response){
			var selectRow = $("#dms_table",container).dmsTable().getSelections();
			var k = selectRow[0];
			$("#invent",getParentModal(container)).dmsTable().appendRow(k);
			$("a[data-dismiss='modal']",container).click();
		}); 
	 	

}); 

	//加载树
var loadTree = function(treeName,location){
	var url = "/decrodateProject/findAllTree";
	//加载树形结构
 	$('#'+treeName,location).initTree({			
		url:dmsCommon.getDmsPath()["vehicle"] + url,
		dataFunc:function(node){
			 return{'id':node.id}
		},			
		loadedFunc: function(e,data){
			}
	}); 
	
/* 	//加载树形结构
	$('#'+treeName,location).initTree({
		url:dmsCommon.getDmsPath()["vehicle"] + url,
		dataFunc:$('.form-horizontal').serialize(),
		loadedFunc: function(e,data){
			 var inst = data.instance;  
			 var obj = inst.get_node(e.target.firstChild.firstChild.lastChild);
			 inst.select_node(obj);  
		}
	}); */
	
	
	
}  



</script>
