<div class="dms-search">
	<form class="form-horizontal">
		<div class="panel panel-default">
			<div class="panel-body">
				<div class="row ">
					<div class="col-xs-12 col-sm-6 col-md-4 col-lg-3">
						<div class="form-group">
							<label class="control-label col-xs-4">品牌</label>
							<div class="col-xs-8">
								<select id="brandId"
									class="bs-select form-control" name="brandCode"
									data-url="/basedata/material/brand/2"
									data-model="manage" data-labelValue="BRAND_ID"
									data-lableDesc="BRAND_NAME">
								</select>
								
							</div>
						</div>
					</div>
					<div class="col-xs-12 col-sm-6 col-md-4 col-lg-3">
						<div class="form-group">
							<label class="control-label col-xs-4">车系</label>
							<div class="col-xs-8">
								<select id="seriesId" parent="brandId"
									class="bs-select form-control" name="seriesName"
									data-url="/basedata/material/series/2/{[brandId]}"
									data-model="manage" data-labelValue="SERIES_ID"
									data-lableDesc="SERIES_NAME">
								</select>
							</div>
						</div>
					</div>
					<div class="col-xs-12 col-sm-6 col-md-4 col-lg-3">
						<div class="form-group">
							<label class="control-label col-xs-4">车款</label>
							<div class="col-xs-8">
								<select id="groupId" parent="seriesId"
									class="bs-select form-control" name="groupName"
									data-url="/basedata/material/group/2/{[seriesId]}"
									data-model="manage" data-labelValue="GROUP_ID"
									data-lableDesc="GROUP_NAME" >
								</select>
							</div>
						</div>
					</div>
					<div class="col-xs-12 col-sm-6 col-md-4 col-lg-3">
						<div class="form-group">
							<label class="control-label col-xs-4">年款</label>
							<div class="col-xs-8">
								<select id="modelId" parent="groupId"
									class="bs-select form-control" name="modelYear"
									data-url="/basedata/material/modelYear/2/{[groupId]}"
									data-model="manage" data-labelValue="MODEL_YEAR"
									data-lableDesc="MODEL_YEAR">
								</select>
							</div>
						</div>
					</div>
					<div class="col-xs-12 col-sm-6 col-md-4 col-lg-3">
						<div class="form-group">
							<label class="control-label col-xs-4">颜色</label>
							<div class="col-xs-8">
								<select id="colorId" parent="modelId"
									class="bs-select form-control" name="colorName"
									data-url="/basedata/material/color/2/{[groupId]}/{[modelId]}"
									data-model="manage" data-labelValue="COLOR_CODE"
									data-lableDesc="COLOR_NAME" >
								</select>
							</div>
						</div>
					</div>
					<div class="col-xs-12 col-sm-6 col-md-4 col-lg-3">
						<div class="form-group">
							<label class="control-label col-xs-4">内饰</label>
							<div class="col-xs-8">
								<select id="trimId" parent="colorId"
									class="bs-select form-control" name="trimName"
									data-url="/basedata/material/trim/2/{[groupId]}/{[modelId]}/{[colorId]}"
									data-model="manage" data-labelValue="TRIM_CODE"
									data-lableDesc="TRIM_NAME" >
								</select>
							</div>
						</div>
					</div>
					<div class="col-xs-12 col-sm-6 col-md-4 col-lg-3">
						<div class="form-group">
							<label class="control-label col-xs-4">客户类型</label>
							<div class="col-xs-8">
								<select id="ctmType" name="ctmType" class="bs-select form-control" data-type="oemDict" data-dictCode="2029" >
								</select>
							</div>
						</div>
					</div>
					<div class="col-xs-12 col-sm-6 col-md-4 col-lg-3">
						<div class="form-group">
							<label class="control-label col-xs-4 ">销售顾问编号</label>
							<div class="col-xs-8">
								<input type="text" class="form-control" id="soldByid" name="soldByid">
							</div>
						</div>
					</div>	
					<div class="col-xs-12 col-sm-12 col-md-8 col-lg-6">
						<div class="form-group">
							<label class="control-label col-xs-4 col-sm-2">交车日期</label>
							<div class="col-xs-8 col-sm-10">
								<div class="input-group input-daterange" data-opens="right">
									<input type="text" class="form-control" readonly name="beginDate" id="beginDate">
								    <span class="input-group-addon">至</span>
								    <input type="text" class="form-control" readonly name="endDate" id="endDate">
									<span class="input-group-btn">
										<button class="btn default input-clear" type="button">
											<i class="fa fa-close"></i>
										</button>
									</span>
								</div>
							</div>
						</div>
					</div>	
					<div class="col-xs-12 col-sm-6 col-md-4 col-lg-3">
						<div class="form-group">
							<label class="control-label col-xs-4 ">销售顾问姓名</label>
							<div class="col-xs-8">
								<input type="text" class="form-control" id="salesAdviser" name="salesAdviser">
							</div>
						</div>
					</div>	
					<div class="col-xs-12 col-sm-6 col-md-4 col-lg-3" data-tableSelect="true">
						<div class="form-group">
							<label class="control-label col-xs-4">经销商代码</label>
							<div class="col-xs-8">
								<div class="input-group">
								<input id="dealerCode" readonly
									name="dealerCode" class="form-control" type="text"
									data-fieldName="dealer_code" /> <span
										class="input-group-btn" >
										<button class="btn default btn-sm" type="button"
											data-url="manage/basedata/dealers/searchDealers.html"
											data-toggle="modal" data-width="modal-lg">
											<i class="fa fa-list-alt"></i>
										</button>
										<button class="btn default input-clear" type="button">
											<i class="fa fa-close"></i>
										</button>
									</span>
								</div>
							</div>
						</div>
					</div>
					<div class="col-xs-12 col-sm-6 col-md-4 col-lg-3">
						<div class="form-group">
							<label class="control-label col-xs-4 ">VIN</label>
							<div class="col-xs-8">
								<textarea class="form-control" id="vin" name="vin" rows="1"></textarea> 
							</div>
						</div>
					</div>
				</div>
				<div class="row ">
					<div class="col-xs-12 ">
						<div class="modal-footer center-block " >
							<a href="javascript:;" class="btn blue" data-onclickEvent="true" id="conutquery">
								<i class="fa fa-search"></i> 汇总查询
							</a>
							<a href="javascript:;" class="btn blue" data-onclickEvent="true" id="conutdetailquery">
								<i class="fa fa-search"></i> 明细查询
							</a>
							<div  class="query-btn" style="display: inline; margin-bottom:5px; margin-left:5px;" >
								<a class="btn blue " ><i class="fa fa-undo"></i>重置 </a>
							</div>
						</div>
					</div>
				</div>
				<div class="panel panel-default table-panel" id = "countId">
					<div class="panel-heading">
						<div class="pannel-name">扫描发票汇总查询信息</div>
						<div class="pannel-button">
							<div class="btn-group btn-group-sm">
								<a href="javascript:;" data-url="/scanInvoiceQuery/export/excel/inventory" data-model="vehicle" data-method="downLoad" data-toggle="confirmation"
										class="btn btn-outline " ><i class="fa fa-download"></i>汇总下载</a> 
							</div>
						</div>
					</div>
					<div class="panel-body">
						<table
							class="table table-striped table-bordered table-hover table-responsive"
							id="forecastQueryTotal_table"></table>
					</div>
				</div>
				<div class="panel panel-default table-panel hidden" id = "detailId">
					<div class="panel-heading">
						<div class="pannel-name">扫描发票明细查询信息</div>
						<div class="pannel-button">
							<div class="btn-group btn-group-sm">
								<a href="javascript:;" data-url="/scanInvoiceQuery/export/excel/total" data-model="vehicle" data-method="downLoad" data-toggle="confirmation"
										class="btn btn-outline " ><i class="fa fa-download"></i>明细下载</a> 
							</div>
						</div>
					</div>
					<div class="panel-body">
						<table
							class="table table-striped table-bordered table-hover table-responsive"
							id="forecastQueryDetail_table"></table>
					</div>
				</div>
			</div>
		</div>
	</form>


</div>
<script type="text/javascript">

$(document).one("onload.dms",function(event,container){
	//汇总查询
	new Datatable().initPagination({
		src : "forecastQueryTotal_table",
		container:container,
		   url : dmsCommon.getDmsPath()["vehicle"] + "/scanInvoiceQuery/totalQuery",
		   rowID : "",
		   autoHeight:false,
		   isQueryFirst:false,
			columns : [ 
			    {field : "DEALER_CODE"	,title : "经销商代码"}, 
        		{field : "DEALER_NAME"	,title : "经销商名称"}, 
        		{field : "SALES_SUM"	,title : "实销上报数量"}
			],
			onLoadSuccess : function() {
				$("#forecastQueryTotal_table",container).dmsTable().bootstrapTable('resetView');
			}
		});
	
	
	
	//明细查询
	new Datatable().initPagination({
		src : "forecastQueryDetail_table",
		container:container,
		rowID:"",
		url : dmsCommon.getDmsPath()["vehicle"] + "/scanInvoiceQuery/inventoryQuery",
		autoHeight:false,
		isQueryFirst:false,
		columns : [ 
		        {field : "SMALL_AREA"			,title : "小区"}, 
				{field : "DEALER_NAME"			,title : "经销商"},
        		{field : "DEALER_CODE"			,title : "经销商代码"}, 
        		{field : "SAP_CODE"				,title : "SAP代码"}, 
        		{field : "CTM_TYPE"				,title : "客户类型",codeFormat : {type:"oemDict",codeType:"2029"}}, 
			    {field : "SERIES_NAME"			,title : "车系"}, 
			    {field : "MODEL_CODE"			,title : "车型代码"}, 
			    {field : "MODEL_NAME"			,title : "车型描述"}, 
			    {field : "MODEL_YEAR"			,title : "年款"}, 
			    {field : "COLOR_NAME"			,title : "颜色"}, 
			    {field : "VIN"					,title : "VIN"}, 
			    {field : "SALES_DATE"			,title : "交车日期"}, 
				{field : "SOLD_BYID"			,title : "销售顾问编号"}, 
				{field : "SALES_ADVISER"		,title : "销售顾问姓名"}, 
				{field : "SOLD_MOBILE"			,title : "销售顾问电话"}, 
				{field : "SOLD_EMAIL"			,title : "销售顾问邮箱"}
		 ],
		 onLoadSuccess : function() {
			$("#forecastQueryDetail_table",container).dmsTable().bootstrapTable('resetView');
		}
	});
	
	
	//绑定汇总查询按钮回调
	$("#conutquery[data-onclickEvent='true']",container).on("dms.click",function(event){
		$("#countId",container).removeClass("hidden");
		$("#detailId",container).addClass("hidden");
		$("#forecastQueryTotal_table",container).dmsTable().refreshTableWithForm();
		
	});
	
	//绑定明细查询按钮回调
	$("#conutdetailquery[data-onclickEvent='true']",container).on("dms.click",function(event){
		$("#detailId",container).removeClass("hidden");
		$("#countId",container).addClass("hidden");
		$("#forecastQueryDetail_table",container).dmsTable().refreshTableWithForm();
	});
	
});
</script>
