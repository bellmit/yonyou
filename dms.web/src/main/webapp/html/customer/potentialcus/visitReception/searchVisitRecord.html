<div class="dms-search">
	<form class="form-horizontal">
		<div class="panel panel-default">
			<div class="panel-body">
				<div class="row ">
					<div class="col-xs-12 col-sm-6 col-md-4 col-lg-3">
						<div class="form-group">
							<label class="control-label col-xs-4">执行状态</label>
							<div class="col-xs-8">
								<select id="perfromStatus" name="perfromStatus"
									class="bs-select form-control" data-dictCode="9005"
									data-value=""></select>
							</div>
						</div>
					</div>
					<!--/span-->
					<div class="col-xs-12 col-sm-6 col-md-4 col-lg-3">
						<div class="form-group form-group-xs m-b-xs">
							<label class="control-label col-xs-4">销售顾问</label>
							<div class="col-xs-8">
								<select id="soldBy" name="soldBy"
									class="bs-select form-control" data-ajaxSync="true"
									data-url="/basedata/employees/-1/salesConsultant" data-value="{[userInfo.userId]}"
									data-model="manage" data-labelValue="USER_ID" 
									data-lableDesc="USER_NAME" >
								</select>
							</div>
						</div>
					</div>
					<!--/span-->
					
					<div class="col-xs-12 col-sm-6 col-md-4 col-lg-3">
						<div class="form-group">
							<label class="control-label col-xs-4">意向车系</label>
							<div class="col-xs-8">
								<select id="intentSeries1"
									class="bs-select form-control" name="intentSeries1"
									data-url="/basedata/selectSeries"
									data-model="manage" data-labelValue="SERIES_CODE"
									data-lableDesc="SERIES_NAME">
								</select>
							</div>
						</div>
					</div> 
					
					<div class="col-xs-12 col-sm-12 col-md-8 col-lg-3">
						<div class="form-group">
							<label class="control-label col-xs-4 col-sm-2">来访日</label>
							<div class="col-xs-8 col-sm-10">
								<div class="input-group input-daterange" 
									data-defaultDays="1" data-date-format="yyyy/mm/dd/hh/mm/ss">
									
									<input type="text" class="form-control" readonly
										name="visit_startdate" id="visit_startdate"> <span
										class="input-group-addon">至</span> <input type="text"
										class="form-control" readonly name="visit_enddate"
										id="visit_enddate">
										 <span class="input-group-btn">
	                                         <button class="btn default input-clear" type="button">
	                                            <i class="fa fa-close"></i>
	                                        </button>
	                                  </span>
									</div>	 
							
							</div>
						</div>
					</div>				
					
                    <div class="col-xs-12 col-sm-6 col-md-4 col-lg-3">
						<div class="form-group">
							<label class="control-label col-xs-4">客户名称</label>
							<div class="col-xs-8 ">
								<input type="text" class="form-control" name="customerName" id="customerName"> 
							</div>
						</div>
					</div>
					<!--/span-->
					<div class="col-xs-12 col-sm-6 col-md-4 col-lg-3">
						<div class="form-group">
							<label class="control-label col-xs-4 ">电话号码</label>
							<div class="col-xs-8">
								<input type="text" class="form-control" id="contactorPhone"
									name="contactorPhone">
							</div>
						</div>
					</div>
					
					<div class="col-xs-12 col-sm-6 col-md-4 col-lg-3">
						<div class="form-group">
							<label class="control-label col-xs-4">来访方式</label>
							<div class="col-xs-8">
								<select id="visitType" name="visitType"
									class="bs-select form-control" data-dictCode="1309"
									data-value=""></select>

							</div>
						</div>
					</div>
					<div class="col-xs-12 col-sm-12 col-md-8 col-lg-3">
						<div class="form-group">
							<label class="control-label col-xs-4 col-sm-2">离店日</label>
							<div class="col-xs-8 col-sm-10">
								<div class="input-group input-daterange" 
									>
									
									<input type="text" class="form-control" readonly
										name="leave_startdate" id="leave_startdate"> <span
										class="input-group-addon">至</span> <input type="text"
										class="form-control" readonly name="leave_enddate"
										id="leave_enddate">
										 <span class="input-group-btn">
	                                         <button class="btn default input-clear" type="button">
	                                            <i class="fa fa-close"></i>
	                                        </button>
	                                  </span>
									</div>	 
							
							</div>
						</div>
					</div>
				
					<div class="col-xs-12 col-sm-6 col-md-4 col-lg-3">
						<div class="form-group">
							<label class="control-label col-xs-4">是否有效客流</label>
							<div class="col-xs-8">
								<select id="isValid" name="isValid"
									class="bs-select form-control" data-dictCode="1278"
									data-value=""></select>

							</div>
						</div>
					</div>
					<!--/span-->
						<div class="col-xs-12 col-sm-6 col-md-4 col-lg-3">
						<div class="form-group">
							<label class="control-label col-xs-4">是否已接待</label>
							<div class="col-xs-8">
								<select id="isStepForwardGreeting" name="isStepForwardGreeting"
									class="bs-select form-control" data-dictCode="1278" data-value="12781002"
									data-value=""></select>

							</div>
						</div>
					</div>
				


				</div>
				
				<div class="row ">
					<div class="col-xs-12 ">
						<div class="query-btn">
							<a href="javascript:;" class="btn blue"> <i
								class="fa fa-search"></i> 查询
							</a> <a href="javascript:;" class="btn blue"><i
								class="fa fa-undo"></i> 重置</a>
						</div>
					</div>
				</div>
			</div>
		</div>
	</form>
	<div class="panel panel-default table-panel">
		<div class="panel-heading">
			<div class="pannel-name">展厅信息列表</div>
			<div class="pannel-button">
				<div class="btn-group btn-group-sm">
					<a data-goback="page"
						data-url="customer/potentialcus/visitReception/addVisitRecord.html" 
						data-toggle="modal" data-width="modal-lg" data-validateUrl="customer/potentialcus/visitReception/addVisitRecord.html"
				 	   data-validateModel="customer"  data-validateMethod=""
						class="btn btn-outline" ><i class="fa fa-plus-square"></i>
						新增</a>
				 	<a class="btn btn-outline" data-url="customer/cusReception/redistribution.html" data-validateUrl="customer/cusReception/redistribution.html"
				 	   data-validateModel="customer"  data-validateMethod="GET" data-toggle="modal"  data-width="modal-lg"> <i class="fa fa-plus-square"></i> 再分配
					</a>
					<a data-url="/customerManage/visitingRecord/export/excel"
						data-model="customer" data-method="downLoad" data-validateUrl="/customerManage/visitingRecord/export/excel"
				 	   data-validateModel="customer"  data-validateMethod=""
						data-toggle="confirmation" class="btn btn-outline "><i class="fa fa-download"></i>导出
					</a>  
				</div>
			</div>
		</div>
		<div class="panel-body">
			<table
				class="table table-striped table-bordered table-hover table-responsive"
				id="dms_table">
			</table>

		</div>
   

	</div>
	<form class="form-horizontal">
	<div class="panel-body">
				<div class="row ">
				 <!-- <div class="col-lg-2">
						<div class="form-group">
							<label class="col-lg-7">总记录数:</label>
							<div class="col-lg-5">
								
							</div>
						</div>
					</div>
					/span
					 <div class="col-lg-2">
						<div class="form-group">
							<label class="col-lg-7">当前记录数:</label>
							<div class="col-lg-5">
								
							</div>
						</div>
					</div> -->
					<!--/span-->
					 <div class="col-lg-3">
						<div class="form-group">
							<label class="col-lg-4">H级客户数:</label>
							<div class="col-lg-8">
								 <input type="text" class="form-control" id="FiH" readonly="readonly"
									name="FiH">
							</div>
						</div>
					</div>
					<!--/span-->
					 <div class="col-lg-3">
						<div class="form-group">
							<label class="col-lg-4">A级客户数:</label>
							<div class="col-lg-8">
								<input type="text" class="form-control" id="FiA" readonly="readonly"
									name="">
							</div>
						</div>
					</div>
					<!--/span-->
					 <div class="col-lg-3">
						<div class="form-group">
							<label class="col-lg-4">B级客户数:</label>
							<div class="col-lg-8">
								<input type="text" class="form-control" id="FiB" readonly="readonly"
									name="">
							</div>
						</div>
					</div>
					<!--/span-->
					 <div class="col-lg-3">
						<div class="form-group">
							<label class="col-lg-4">C级客户数:</label>
							<div class="col-lg-8">
								<input type="text" class="form-control" id="FiC" readonly="readonly"
									name="">
							</div>
						</div>
					</div>
					<div class="col-xs-12">
						<div class="form-group">
							&nbsp	
						</div>
					</div>
					<div class="col-xs-12">
						<div class="form-group">
								客户级别：H-1周内成交；A-半个月内成交；B-1个月内成交；C-3个月内成交；N-潜在客户
						</div>
					</div>
					<div class="col-xs-12">
						<div class="form-group">
							&nbsp	
						</div>
					</div>
					 <div class="col-lg-3">
						<div class="form-group">
							<label class="col-lg-4">首次客流:</label>
							<div class="col-lg-8">
								<input type="text" class="form-control" id="first" readonly="readonly"
									name="">
							</div>
						</div>
					</div>
					 <div class="col-lg-3">
						<div class="form-group">
							<label class="col-lg-4">混合客流:</label>
							<div class="col-lg-8">
								<input type="text" class="form-control" id="unfirst" readonly="readonly"
									name="">
							</div>
						</div>
					</div>
					<!--/span-->
				</div>
		</div>
	</form>
</div>
<script type="text/javascript">
$(document).one("onload.dms",function(event,container){
	new Datatable().initPagination({
		src : "dms_table",
		container:container,
		    url : dmsCommon.getDmsPath()["customer"] + "/customerManage/visitingRecord",
			rowID : "ITEM_ID",
			sortName : "VISIT_TIME",
			sortOrder : "desc",
			  checkboxHeader:true,
			/* selectItemName:"cusId",  */
			autoHeight : false,
			undefinedText : "",
			columns : [ 
				{radio:true},
				//{checkbox:true,sortable : true},  
			    {field : "ITEM_ID",title : "操作",operateFormat : [
                       {type:"edit",url:"customer/potentialcus/visitReception/editVisitRecord.html" ,attr:'data-validateUrl="customer/potentialcus/visitReception/editVisitRecord.html"'
    				 	  ,openWidth:"modal-lg"} ,
                       /* {type:"del",url:"/customerManage/visitingRecord/{[ITEM_ID]}",model:"customer",callBack:function(response){
                    	   $("#dms_table",getElementContext()).dmsTable().refreshTableWithForm();
                       }}, */
                       {type:"edit",url:"customer/potentialcus/visitReception/editCusInfo.html" ,attr:'data-validateUrl="customer/potentialcus/visitReception/editCusInfo.html"',openWidth:"modal-lg",title:"建档",operateIcon:'<i class="fa fa-lg fa-user-plus"></i>',isShow:function(value, row, index){
                       			if(row.CUSTOMER_NO == null){
                       				return true;
                       			}else{
                       				return false;
                       			}
                       	}},  
                       {type:"edit",url:"customer/potentialcus/visitReception/addPoteCusFollow.html",openWidth:"modal-lg",title:"接待",operateIcon:'<i class="glyphicon glyphicon-phone-alt"></i>',isShow:function(value, row, index){
                    	        if(row.CUSTOMER_NO != null){
                    	        	return true;
                    	        }else{
                    	        	return false;
                    	        }
                       } 
                       }
                    ]
                }, 
                {field : "CUSTOMER_NO",title : "客户编号"},
                {field : "CUSTOMER_NAME",title : "客户名称"},
                {field : "IS_STEP_FORWARD_GREETING",title : "是否已接待",codeFormat : {type:"dict",codeType:"1278"}},
                {field : "IS_FIRST_VISIT",title : "是否首次客流",codeFormat : {type:"dict",codeType:"1278"}},
                {field : "IS_VALID",title : "是否有效客流",codeFormat : {type:"dict",codeType:"1278"}},
                {field : "IS_TEST_DRIVE",title : "是否试乘试驾",codeFormat : {type:"dict",codeType:"1278"}},
                {field : "CUS_SOURCE",title : "客户来源",codeFormat : {type:"dict",codeType:"1311"}},               
                {field : "CON",title : "联系人"},
                {field : "CONTACTOR_PHONE",title : "联系人电话"},
                {field : "CONTACTOR_MOBILE",title : "联系人手机"},
                {field : "COMPLAINT_RESULT",title : "来访结果",codeFormat : {type:"dict",codeType:"1328"}},
                {field : "INTENT_LEVEL",title : "意向级别",codeFormat : {type:"dict",codeType:"1310"}},
                {field : "SERIES_NAME",title : "意向车系"},
                {field : "MODEL_NAME",title : "意向车型"},
                {field : "CONFIG_NAME",title : "意向配置"},
                {field : "COLOR_NAME",title : "颜色"},
                {field : "MEDIA_TYPE",title : "信息渠道",codeFormat : {type:"dict",codeType:"1298"}},
                {field : "VISITOR",title : "来访人数"},
                {field : "USER_NAME",title : "销售顾问"},
                {field : "NAME",title : "再分配",inputHiddenFormat : {hiddenField:"NEXT_CONSULTANT"}},
                {field : "VISIT_TYPE",title : "来访方式",codeFormat : {type:"dict",codeType:"1309"}},
                {field : "QUOTED_AMOUNT",title : "初次报价",numberFormat : {decimal:2}},
                {field : "VISIT_TIME",title : "来访时间",dateFormat : {format:"YYYY-MM-DD HH:mm:ss"}},              
                {field : "LEAVE_TIME",title : "离店时间",dateFormat : {format:"YYYY-MM-DD HH:mm:ss"}},
                {field : "SCENE",title : "经过情形"},
                {field : "CAMPAIGN_CODE",title : "市场活动"},
                {field : "CONTACT_TIME",title : "接触时长（分钟）"},
                {field : "MEDIA_DETAIL",title : "渠道细分"}, 
                {field : "GENDER",title : "客户性别",codeFormat : {type:"dict",codeType:"1006"}}
			],
			onLoadSuccess : function() {
				var table = $("#dms_table",
						getElementContext()).dmsTable()
						.getRowDataByIndex();
				var h = 0;
				var a = 0;
				var b = 0;
				var c = 0;
				var f = 0;
				var unf = 0;
				for (var i = 0; i < table.length; i++) {
					var intent = table[i].INTENT_LEVEL;
					var ifv = table[i].IS_FIRST_VISIT;

					if(intent == '13101001'){
						h += 1;
					}else if(intent == '13101002'){
						a += 1;
					}else if(intent == '13101003'){
						b += 1;
					}else if(intent == '13101004'){
						c += 1;
					}
					if(ifv == '12781001'){
						f += 1;
					}else if(ifv == '12781002'){
						unf += 1;
					}
				}
				$("#FiH",container).val(h);
				$("#FiA",container).val(a);
				$("#FiB",container).val(b);
				$("#FiC",container).val(c);
				$("#first",container).val(f);
				$("#unfirst",container).val(unf);
			}
		});
	});
	
	/* $(document).one("onload.dms",function(event,container){
		$("#FiH",container).ready(function(){
			var selectRow = $("#dms_table",container).dmsTable().getSelections();
			alert(selectRow);
		    var H = $("#FiH",container).attr("disabled",true);
		
		});
	}); */
</script>