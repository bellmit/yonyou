<div class="dms-edit ajaxrest" data-url="/ordermanage/salesOrders/{[SO_NO]}" data-model="retail" data-pageInitCallBack="true">
	<form class="form-horizontal">
		<div class="panel panel-default" >
		
		                   <div class="panel-heading">
								<div class="pannel-name">订单信息</div>
								<div class="pannel-tools">
									<a href="javascript:;" class="expand"> <i
										class="fa fa-chevron-down"></i></a>
								</div>
							</div>
			<div class="panel-body">
				<div class="row">
				<div class="col-xs-12 col-sm-6 col-md-4">
						<div class="form-group">
							<label class="control-label col-xs-4">销售单号</label>
							<div class="col-xs-8">
								<input id="soNo" name="soNo"
									data-fieldName="SO_NO" class="form-control" type="text"
									 />
							</div>
						</div>
					</div>
					<div  data-tableCustomerSelect="true" data-tableWsNoSelect="true">
					
                    <!-- 	<div class="col-xs-12 col-sm-6 col-md-4">
						<div class="form-group">
							<label class="control-label col-xs-4">销售单号</label>
							<div class="col-xs-8 ">
								<div class="input-group">
									<input type="text" class="form-control" id="soNo"
										readonly="readonly" name="soNo"
										data-fieldName="SO_NO" /> 
									<span class="input-group-btn">
										<button class="btn default btn-sm" type="button"
											data-url="retail/ordermanage/salesorder/selectPotentialGuest.html"
											data-toggle="modal" data-width="modal-lg">
											<i class="fa fa-list-alt"></i>
										</button>
										<button class="btn default input-clear" type="button">
											<i class="fa fa-close"></i>
										</button>
									</span>
								</div>
							</div>
						</div>
					</div> -->
					<div class="col-xs-12 col-sm-6 col-md-4">
						<div class="form-group">
							<label class="control-label col-xs-4">※客户编号</label>
							<div class="col-xs-8 ">
								<div class="input-group">
									<input type="text" class="form-control required" id="customerNo"
										readonly="readonly" name="customerNo"
										data-fieldName="CUSTOMER_NO" /> 
									<input type="hidden" class="form-control" id="customerName" name="customerName"
										data-fieldName="CUSTOMER_NAME" /> 
									<span class="input-group-btn">
										<button class="btn default btn-sm" type="button"
											data-url="retail/ordermanage/salesorder/searchCustomer.html"
											data-toggle="modal" data-width="modal-lg">
											<i class="fa fa-list-alt"></i>
										</button>
										<button class="btn default input-clear" type="button">
											<i class="fa fa-close"></i>
										</button>
									</span>
								</div>
							</div>
						</div>
					</div>
						<div class="col-xs-12 col-sm-6 col-md-4">
						<div class="form-group">
							<label class="control-label col-xs-4">大客户报备</label>
							<div class="col-xs-8 ">
								<div class="input-group">
									<input type="text" class="form-control" id="wsNo"
										 name="wsNo" readonly
										data-fieldName="WS_NO" /> 
										<input type="hidden" class="form-control" id="wsName" name="wsName"
										data-fieldName="WS_NAME" /> <span
										class="input-group-btn">
										<button class="btn default btn-sm" type="button"
											data-url="retail/ordermanage/salesorder/selectBigCustomer.html"
											data-toggle="modal" data-width="modal-lg">
											<i class="fa fa-list-alt"></i>
										</button>
										<button class="btn default input-clear" type="button">
											<i class="fa fa-close"></i>
										</button>
									</span>
								</div>
							</div>
						</div>
					</div>
						<div class="col-xs-12 col-sm-6 col-md-4">
						<div class="form-group">
							<label class="control-label col-xs-4">意向单号</label>
							<div class="col-xs-8 ">
								<div class="input-group">
									<input type="text" class="form-control" id="intentSoNo"
										readonly="readonly" name="intentSoNo"
										data-fieldName="INTENT_SO_NO" /> <input type="hidden"
										class="form-control" id="customerId" name="customerId"
										data-fieldName="PART_CUSTOMER_ID" /> <span
										class="input-group-btn">
										<button class="btn default btn-sm" type="button"
											data-url="retail/ordermanage/salesorder/selectIntentionOrder.html"
											data-toggle="modal" data-width="modal-lg">
											<i class="fa fa-list-alt"></i>
										</button>
										<button class="btn default input-clear" type="button">
											<i class="fa fa-close"></i>
										</button>
									</span>
								</div>
							</div>
						</div>
					</div>

					<div class="col-xs-12 col-sm-6 col-md-4">
						<div class="form-group">
							<label class="control-label col-xs-4">客户名称</label>
							<div class="col-xs-8">
								<input id="customerName" name="customerName"
									data-fieldName="CUSTOMER_NAME" class="form-control" type="text"
									disabled="disabled" />
							</div>
						</div>
					</div>
						<div class="col-xs-12 col-sm-6 col-md-4">
							<div class="form-group">
								<label class="control-label col-xs-4">客户类型</label>
								<div class="col-xs-8">
									<select id="customerType" name="customerType"
										data-fieldName="CUSTOMER_TYPE" class="bs-select form-control"
										data-dictCode="1018" data-value=""></select>
								</div>
							</div>
						</div>
						<!--/span-->
							<div class="col-xs-12 col-sm-6 col-md-4">
							<div class="form-group">
								<label class="control-label col-xs-4">客户来源</label>
								<div class="col-xs-8">
									<select id="cusSource" name="cusSource"
										data-fieldName="CUS_SOURCE" class="form-control"
										data-dictCode="1311" data-value=""></select>
								</div>
							</div>
						</div>
						<!--/span-->
						<div class="col-xs-12 col-sm-6 col-md-4">
							<div class="form-group">
								<label class="control-label col-xs-4">证件类型</label>
								<div class="col-xs-8">
									<select id="ctCode" name="ctCode" data-fieldName="CT_CODE"
										class="bs-select form-control" data-dictCode="1239"
										data-value="">
									</select>
								</div>
							</div>
						</div>
						<!--/span-->
						<div class="col-xs-12 col-sm-6 col-md-4">
							<div class="form-group">
								<label class="control-label col-xs-4 ">证件号</label>
								<div class="col-xs-8 ">
									<input id="certificateNo" name="certificateNo" data-fieldName="CERTIFICATE_NO"
										class="form-control" type="text" />
								</div>
							</div>
						</div>
						<!--/span-->
                    <div class="col-xs-12 col-sm-6 col-md-4">
						<div class="form-group">
							<label class="control-label col-xs-4">联系人</label>
							<div class="col-xs-8">
								<input id="contactorName" name="contactorName" class="form-control"
									type="text" disabled="disabled" data-fieldName="CONTACTOR_NAME" readonly="readonly"/>
							</div>
						</div>
					</div>
					<div class="col-xs-12 col-sm-6 col-md-4">
						<div class="form-group">
							<label class="control-label col-xs-4">联系手机</label>
							<div class="col-xs-8">
								<input id="mobile" name="mobile" class="form-control"
									type="text" disabled="disabled" data-fieldName="MOBILE" />
							</div>
						</div>
					</div>

					<div class="col-xs-12 col-sm-12 col-md-8">
						<div class="form-group">
							<label class="control-label col-xs-4 col-sm-2">地址</label>
							<div class="col-xs-8 col-sm-10">
								<input id="address" name="address" class="form-control"
									type="text" disabled="disabled" data-fieldName="ADDRESS" />
							</div>
						</div>
					</div>
			</div>
					<div class="col-xs-12 col-sm-6 col-md-4">
						<div class="form-group">
							<label class="control-label col-xs-4">开单日期</label>
							<div class="col-xs-8">
								<div class="input-group date date-picker" data-defaultToday="true">
									<input id="sheetCreateDate" name="sheetCreateDate" readonly
										class="form-control" type="text" />
										<span class="input-group-btn">
										<button class="btn default date-set" type="button">
											<i class="fa fa-calendar"></i>
										</button>
										<button class="btn default date-reset" type="button">
											<i class="fa fa-times"></i>
										</button>
									</span>
								</div>
							</div>
						</div>
					</div>

					<div class="col-xs-12 col-sm-6 col-md-4">
						<div class="form-group form-group-xs m-b-xs">
							<label class="control-label col-xs-4">开单人</label>
							<div class="col-xs-8">
								<select id="sheetCreatedBy" name="sheetCreatedBy"
									data-fieldName="SHEET_CREATED_BY" class="bs-select form-control"
									data-url="/basedata/employees/-1/salesConsultant" data-value="{[userInfo.userId]}"
									data-model="manage" data-labelValue="USER_ID"
									data-lableDesc="USER_NAME">
								</select>
							</div>
						</div>
					</div>

					<div class="col-xs-12 col-sm-6 col-md-4">
						<div class="form-group">
							<label class="control-label col-xs-4">签约日期</label>
							<div class="col-xs-8">
								<div class="input-group date date-picker" data-defaultToday="true">
									<input id="contractDate" name="contractDate" readonly
										class="form-control" type="text" /> <span
										class="input-group-btn">
										<button class="btn default date-set" type="button">
											<i class="fa fa-calendar"></i>
										</button>
                                              <button class="btn default date-reset" type="button">
                                                  <i class="fa fa-times"></i>
                                              </button>
									</span>
								</div>
							</div>
						</div>
					</div>

					<div class="col-xs-12 col-sm-6 col-md-4">
						<div class="form-group form-group-xs m-b-xs">
							<label class="control-label col-xs-4">销售顾问</label>
							<div class="col-xs-8">
								<select id="soldBy" name="soldBy"
									class="bs-select form-control"
									data-url="/basedata/employees/-1/salesConsultant"
									data-model="manage" data-labelValue="USER_ID" data-value="{[userInfo.userId]}"
									data-lableDesc="USER_NAME" data-fieldName="SOLD_BY">
								</select>
							</div>
						</div>
					</div>

					<div class="col-xs-12 col-sm-6 col-md-4">
						<div class="form-group">
							<label class="control-label col-xs-4">合约编号</label>
							<div class="col-xs-8">
								<input id="contractNo" name="contractNo" class="form-control"
									type="text" maxlength="30" data-fieldName="CONTRACT_NO"/>
							</div>
						</div>
					</div>
					<div class="col-xs-12 col-sm-6 col-md-4">
						<div class="form-group">
							<label class="control-label col-xs-4">合约定金</label>
							<div class="col-xs-8">
								<input id="contractEarnest" name="contractEarnest"
									class="form-control decimal" type="text" maxDigit="12" maxPrecision="2" data-fieldName="CONTRACT_EARNEST"/>
							</div>
						</div>
					</div>


					<div class="col-xs-12 col-sm-6 col-md-4">
						<div class="form-group">
							<label class="control-label col-xs-4">预交车时间</label>
							<div class="col-xs-8">
								<div class="input-group date date-picker" data-defaultToday="true">
									<input id="deliveringDate" name="deliveringDate" readonly
										class="form-control" type="text" data-fieldName="DELIVERING_DATE"/> <span
										class="input-group-btn">
										<button class="btn default date-set" type="button">
											<i class="fa fa-calendar"></i>
										</button>
										<button class="btn default date-reset" type="button">
											<i class="fa fa-times"></i>
										</button>
									</span>
								</div>
							</div>
						</div>
					</div>
					<div class="col-xs-12 col-sm-6 col-md-4">
						<div class="form-group">
							<label class="control-label col-xs-4">官网交车方式</label>
							<div class="col-xs-8">
								<select class="bs-select form-control" id="deliveryModeElec"
									name="deliveryModeElec" data-dictCode="1600" data-fieldName="DELIVERY_MODE_ELEC" >
								</select>
							</div>
						</div>
					</div>

					<div class="col-xs-12 col-sm-6 col-md-4">
						<div class="form-group">
							<label class="control-label col-xs-4">交车方式</label>
							<div class="col-xs-8">
								<select class="bs-select form-control required" id="deliveryMode"
									name="deliveryMode" data-dictCode="1302" data-fieldName="DELIVERY_MODE" data-excludeItems="13021002" data-value="13021001">
								</select>
							</div>
						</div>
					</div>
						<div class="col-xs-12 col-sm-6 col-md-4">
						<div class="form-group">
							<label class="control-label col-xs-4">支付方式</label>
							<div class="col-xs-8">
								<select class="bs-select form-control required" id="payMode"
									name="payMode" data-dictCode="1025" data-fieldName="PAY_MODE" data-excludeItems="10251002" data-value="10251001">
								</select>
							</div>
						</div>
					</div>
						<div class="col-xs-12 col-sm-6 col-md-4">
						<div class="form-group">
							<label class="control-label col-xs-4">开票方式</label>
							<div class="col-xs-8">
								<select class="bs-select form-control required" id="invoiceMode"
									name="invoiceMode" data-dictCode="1303" data-fieldName="INVOICE_MODE"  data-value="13031001">
								</select>
							</div>
						</div>
					</div>
					<!--/span-->
						<div class="col-xs-12 col-sm-6 col-md-4">
						<div class="form-group">
							<label class="control-label col-xs-4">订单状态</label>
							<div class="col-xs-8">
								<select class="bs-select form-control" id="soStatus"
									name="soStatus" data-dictCode="1301" data-fieldName="SO_STATUS">
								</select>
							</div>
						</div>
					</div>
					<!--/span-->
									<div class="col-xs-12 col-sm-6 col-md-4">
										<div class="form-group">
											<label class="control-label col-xs-4">省份</label>
											<div class="col-xs-8">
												<select id="province" class="bs-select form-control"
													name="province" 
													data-type="region">
												</select>
											</div>
										</div>
									</div>
									<!--/span-->
									<div class="col-xs-12 col-sm-6 col-md-4">
										<div class="form-group">
											<label class="control-label col-xs-4">城市</label>
											<div class="col-xs-8">
												<select parent="province" class="bs-select form-control" 
												name="city" id="city" >
												</select>
											</div>
										</div>
									</div>
									<!--/span-->
									<div class="col-xs-12 col-sm-6 col-md-4">
										<div class="form-group">
											<label class="control-label col-xs-4">区县</label>
											<div class="col-xs-8">
												<select parent="city" id="district"
													class="bs-select form-control" name="district" >
													</select>
											</div>
										</div>
									</div>
									<!--/span-->
				</div>
			</div>
		</div>
		<div class="panel panel-default" >
		
		                   <div class="panel-heading">
								<div class="pannel-name">车辆信息</div>

								<div class="pannel-tools">
									<a href="javascript:;" class="expand"> <i
										class="fa fa-chevron-down"></i></a>
								</div>
							</div>
			<div class="panel-body">
				<div class="row">


					
					<div data-tableVINSelect="true" data-tableProductSelect="true">
					<div class="col-xs-12 col-sm-6 col-md-4">
						<div class="form-group">
							<label class="control-label col-xs-4">VIN号</label>
							<div class="col-xs-8 ">
								<div class="input-group">
									<input type="text" class="form-control" id="vin" name="vin"
										data-fieldName="VIN" readonly />
									<input type="hidden" class="form-control" id="vsStockId" name="vsStockId"
										data-fieldName="VS_STOCK_ID" />
									<input type="hidden" class="form-control" id="vehicleId" name="vehicleId"
										data-fieldName="VEHICLE_ID" />
									<span class="input-group-btn">
										<button class="btn default btn-sm" type="button"
											data-url="retail/ordermanage/salesorder/selectVIN.html"
											data-toggle="modal" data-width="modal-lg">
											<i class="fa fa-list-alt"></i>
										</button>
										<button class="btn default input-clear" type="button">
											<i class="fa fa-close"></i>
										</button>
									</span>
								</div>
							</div>
						</div>
					</div>

					<div class="col-xs-12 col-sm-6 col-md-4">
						<div class="form-group">
							<label class="control-label col-xs-4">品牌</label>
							<div class="col-xs-8">
								<select id="brand" class="bs-select form-control" name="brand"
									data-url="/basedata/brandsdict" data-model="manage" data-fieldName="BRAND_CODE"
									data-labelValue="BRAND_CODE" data-lableDesc="BRAND_NAME"
									>
								</select>
							</div>
						</div>
					</div>
					<div class="col-xs-12 col-sm-6 col-md-4">
						<div class="form-group">
							<label class="control-label col-xs-4">车系</label>
							<div class="col-xs-8">
								<select id="series" parent="brand"
									class="bs-select form-control" name="series"
									data-url="/basedata/brandsdictC/{[brand]}/seriessdictC"
									data-model="manage" data-labelValue="SERIES_CODE" data-fieldName="SERIES_CODE"
									data-lableDesc="SERIES_NAME" disabled="disabled">
								</select>
							</div>
						</div>
					</div>


					<div class="col-xs-12 col-sm-6 col-md-4">
						<div class="form-group">
							<label class="control-label col-xs-4">车型</label>
							<div class="col-xs-8">
								<select id="model" parent="series"
									class="bs-select form-control" name="model"
									data-url="/basedata/brandsdictC/{[brand]}/seriessdictC/{[series]}/modelsdictC"
									data-model="manage" data-labelValue="MODEL_CODE" data-fieldName="MODEL_CODE"
									data-lableDesc="MODEL_NAME" disabled="disabled">
								</select>
							</div>
						</div>
					</div>


					<div class="col-xs-12 col-sm-6 col-md-4">
						<div class="form-group">
							<label class="control-label col-xs-4">配置</label>
							<div class="col-xs-8">
								<select id="config" parent="model" class="bs-select form-control" name="config"
									data-url="/basedata/brandsdictC/{[brand]}/seriessdictC/{[series]}/modelsdictC/{[model]}/packagesdictC"
									data-model="manage" data-labelValue="CONFIG_CODE" disabled="disabled"
									data-lableDesc="CONFIG_NAME"  data-fieldName="CONFIG_CODE">
								</select>
							</div>
						</div>
					</div>
					<div class="col-xs-12 col-sm-6 col-md-4">
						<div class="form-group form-group-xs m-b-xs">
							<label class="control-label col-xs-4">颜色</label>
							<div class="col-xs-8">
								<select id="color"  disabled="disabled"
									class="bs-select form-control" name="color" data-fieldName="COLOR_CODE"
									data-url="/basedata/colors/colorinfo/dicts" data-model="repair"
									data-labelValue="COLOR_CODE" data-lableDesc="COLOR_NAME">
								</select>
							</div>
						</div>
					</div>

					<div class="col-xs-12 col-sm-6 col-md-4">
					      <div class="form-group">
								<label class="control-label col-xs-4">产品代码</label>
								<div class="col-xs-8">
									<div class="input-group">
										<input type="hidden" name='seNo' value='{[SE_NO]}' /> 
										<input id="productCode" readonly name="productCode"
											class="form-control required" type="text" data-fieldName="PRODUCT_CODE"/> 
										<span class="input-group-btn">
											<button class="btn default btn-sm" type="button"
												data-url="retail/ordermanage/salesorder/searchProduct.html"
												data-toggle="modal" data-width="modal-lg">
												<i class="fa fa-sitemap"></i>
											</button>
											<button class="btn default input-clear" type="button">
												<i class="fa fa-close"></i>
											</button>
										</span>
									</div>
								</div>
							</div>
						<!-- <div class="form-group">
							<label class="control-label col-xs-4">产品代码</label>
							<div class="col-xs-8 ">
								<div class="input-group">
									<input type="text" class="form-control"
										id="productCode" name="productCode"
										data-fieldName="PRODUCT_CODE" readonly /> <input
										type="hidden" class="form-control" id="productId"
										name="productId" data-fieldName="PRODUCT_ID" /> <span
										class="input-group-btn">
										<button class="btn default btn-sm" type="button"
											data-url="retail/ordermanage/salesorder/selectBrand.html"
											data-toggle="modal" data-width="modal-lg">
											<i class="fa fa-list-alt"></i>
										</button>
										<button class="btn default input-clear" type="button">
											<i class="fa fa-close"></i>
										</button>
									</span>
								</div>
							</div>
						</div> -->
					</div>

					<div class="col-xs-12 col-sm-6 col-md-4">
						<div class="form-group">
							<label class="control-label col-xs-4">产品名称</label>
							<div class="col-xs-8">
								<input id="productname" name="productname" data-fieldName="PRODUCT_NAME" 
									class="form-control" type="text" disabled="disabled" />
							</div>
						</div>
					</div>
						<div class="col-xs-12 col-sm-6 col-md-4">
						<div class="form-group">
							<label class="control-label col-xs-4">车辆用途</label>
							<div class="col-xs-8">
								<select class="bs-select form-control required" id="vehiclePurpose"
									name="vehiclePurpose" data-dictCode="1193" data-value="11931002">
								</select>
							</div>
						</div>
					</div>
					<!--/span-->

					<div class="col-xs-12 col-sm-6 col-md-4">
						<div class="form-group">
							<label class="control-label col-xs-4">发动机号</label>
							<div class="col-xs-8">
								<input id="engineNo" name="engineNo" class="form-control"
									type="text" disabled="disabled" data-fieldName="ENGINE_NO" />
							</div>
						</div>
					</div>

					<div class="col-xs-12 col-sm-6 col-md-4">
						<div class="form-group">
							<label class="control-label col-xs-4">合格证号</label>
							<div class="col-xs-8">
								<input id="certificateNumber" name="certificateNumber"
									class="form-control" type="text" disabled="disabled" data-fieldName="CERTIFICATE_NUMBER" />
							</div>
						</div>
					</div>
					</div>
					<div data-tableAllLoanRateSelect="true">
					<div class="col-xs-12 col-sm-6 col-md-4">
						<div class="form-group">
							<label class="control-label col-xs-4">付款银行</label>
							<div class="col-xs-8">
								<select class="bs-select form-control" id="loanOrg"
									name="loanOrg" data-url="/basedata/BasicParameters/paying/bank" data-model="manage"
									data-labelValue="BANK_CODE" data-lableDesc="BANK_NAME"
								    data-fieldName="LOAN_ORG">
								</select>
							</div>
						</div>
					</div>
					<!--/span-->
					<div class="col-xs-12 col-sm-6 col-md-4">
						<div class="form-group">
							<label class="control-label col-xs-4">分期期数</label>
							<div class="col-xs-8">
								<select class="bs-select form-control" id="installmentNumber"
									name="installmentNumber" data-dictCode="3387" data-fieldName="INSTALLMENT_NUMBER">
								</select>
							</div>
						</div>
					</div>
					<!--/span-->
				
						<div class="col-xs-12 col-sm-6 col-md-4">
						<div class="form-group">
							<label class="control-label col-xs-4">贷款总金额</label>
							<div class="col-xs-8">
								<input id="installmentAmount" name="installmentAmount" class="form-control"
									type="text" disabled="disabled" data-fieldName="INSTALLMENT_AMOUNT" />
							</div>
						</div>
					</div>
					<!--/span-->
					<div class="col-xs-12 col-sm-6 col-md-4">
						<div class="form-group">
							<label class="control-label col-xs-4">首付比例(%)</label>
							<div class="col-xs-5">
								<input id="firstPermentRatio" name="firstPermentRatio" class="form-control"
									type="text" disabled="disabled" data-fieldName="FIRST_PERMENT_RATIO" />
							</div>
							<div class="col-xs-3">
								<!-- <a data-goback="page" href="retail/ordermanage/salesorder/addSalesOrder.html"
						    class="btn blue"><i class="fa fa-plus-square"></i> 金融方案</a> -->
					   <a class="btn blue"  data-beforeShowEvent="true"
						data-url="retail/ordermanage/salesorder/selectAllLoanRate.html"  disabled
						data-toggle="modal" data-width="modal-lg" id="allLoanRate"> <i class="fa fa-plus-square"></i>
						金融方案
					</a> 
					<!-- <button class="btn blue" type="button" 
												data-url="retail/ordermanage/salesorder/selectAllLoanRate.html"
												data-toggle="modal" data-width="modal-lg" data-beforeShowEvent="true">
												<i class="fa fa-plus-square">金融方案</i>
			        </button> -->
							</div>
							
						</div>
					</div>
					<!--/span-->
						<div class="col-xs-12 col-sm-6 col-md-4">
						<div class="form-group">
							<label class="control-label col-xs-4">首付比例范围(%)</label>
							<div class="col-xs-4">
								<input id="firstPermentRangeS" name="firstPermentRangeS" class="form-control"
									type="text" disabled="disabled" data-fieldName="FIRST_PERMENT_RANGE_S" />
							</div>
							<label class="control-label col-xs-1">至</label>
							<div class="col-xs-3">
								<input id="firstPermentRangeE" name="firstPermentRangeE" class="form-control"
									type="text" disabled="disabled" data-fieldName="FIRST_PERMENT_RANGE_E" />
							</div>
							
						</div>
					</div>
					<!--/span-->
					<div class="col-xs-12 col-sm-6 col-md-4">
						<div class="form-group">
							<label class="control-label col-xs-4">贴息率(%)</label>
							<div class="col-xs-8">
								<input id="loanRate" name="loanRate" class="form-control"
									type="text" disabled="disabled" data-fieldName="LOAN_RATE" />
							</div>
						</div>
					</div>
					<!--/span-->
					</div>
					
				</div>
			</div>
		</div>
		<div class="panel panel-default" >
		
		                   <div class="panel-heading">
								<div class="pannel-name">二手车车辆信息</div>

								<div class="pannel-tools">
									<a href="javascript:;" class="expand"> <i
										class="fa fa-chevron-down"></i></a>
								</div>
							</div>
			<div class="panel-body">
				<div class="row">

	<!--/span-->
	<div  data-tableOldVINSelect="true">
					<div class="col-xs-12 col-sm-6 col-md-4">
						<div class="form-group">
							<label class="control-label col-xs-4">是否置换</label>
							<div class="col-xs-8">
								<select class="form-control" id="isPermuted"
									name="isPermuted" data-dictCode="1278">
								</select>
							</div>
						</div>
					</div>
			
							<!--/span-->
					<div data-tableSelect2="true">
					<div class="col-xs-12 col-sm-6 col-md-4">
						<div class="form-group">
							<label class="control-label col-xs-4">二手车VIN</label>
							<div class="col-xs-8 ">
								<div class="input-group">
									<input type="text" class="form-control" id="permutedVin" name="permutedVin"
										data-fieldName="PERMUTED_VIN" disabled="disabled" />
									<input type="hidden" class="form-control" id="vsStockId" name="vsStockId"
										data-fieldName="VS_STOCK_ID" />
									<input type="hidden" class="form-control" id="vehicleId" name="vehicleId"
										data-fieldName="VEHICLE_ID" />
									<span class="input-group-btn">
										<button class="btn default btn-sm" type="button"
											data-url="retail/ordermanage/salesorder/selectOldVIN.html"
											data-toggle="modal" data-width="modal-lg">
											<i class="fa fa-list-alt"></i>
										</button>
										<button class="btn default input-clear" type="button">
											<i class="fa fa-close"></i>
										</button>
									</span>
								</div>
							</div>
						</div>
					</div>

					<div class="col-xs-12 col-sm-6 col-md-4">
						<div class="form-group">
							<label class="control-label col-xs-4">品牌</label>
							<div class="col-xs-8">
								<select id="oldBrandCode" class="bs-select form-control" name="oldBrandCode"
									data-url="/basedata/brandsdict" data-model="manage"
									data-labelValue="BRAND_CODE" data-lableDesc="BRAND_NAME"
									 data-fieldName="OLD_BRAND_CODE" disabled="disabled">
								</select>
							</div>
						</div>
					</div>
					<div class="col-xs-12 col-sm-6 col-md-4">
						<div class="form-group">
							<label class="control-label col-xs-4">车系</label>
							<div class="col-xs-8">
								<select id="oldSeriesCode" parent="oldBrandCode"
									class="bs-select form-control" name="oldSeriesCode"
									data-url="/basedata/brandsdictC/{[oldBrandCode}/seriessdictC"
									data-model="manage" data-labelValue="SERIES_CODE" data-fieldName="OLD_SERIES_CODE"
									data-lableDesc="SERIES_NAME" disabled="disabled">
								</select>
							</div>
						</div>
					</div>


					<div class="col-xs-12 col-sm-6 col-md-4">
						<div class="form-group">
							<label class="control-label col-xs-4">车型</label>
							<div class="col-xs-8">
								<select id="oldModelCode" parent="oldSeriesCode"
									class="bs-select form-control" name="oldModelCode"
									data-url="/basedata/brandsdictC/{[oldBrandCode]}/seriessdictC/{[oldSeriesCode]}/modelsdictC"
									data-model="manage" data-labelValue="MODEL_CODE" data-fieldName="OLD_MODEL_CODE"
									data-lableDesc="MODEL_NAME" disabled="disabled">
								</select>
							</div>
						</div>
					</div>

                     <div class="col-xs-12 col-sm-6 col-md-4">
						<div class="form-group">
							<label class="control-label col-xs-4">车牌号</label>
							<div class="col-xs-8">
								<input id="assessedLicense" name="assessedLicense" class="form-control"
									type="text" disabled="disabled" data-fieldName="ASSESSED_LICENSE" />
							</div>
						</div>
					</div>
					
				  <div class="col-xs-12 col-sm-6 col-md-4">
						<div class="form-group">
							<label class="control-label col-xs-4">评估金额</label>
							<div class="col-xs-8">
								<input id="assessedPrice" name="assessedPrice" data-fieldName="ASSESSED_PRICE" 
									class="form-control" type="text" disabled="disabled" />
							</div>
						</div>
					</div>
			

					<div class="col-xs-12 col-sm-6 col-md-4">
						<div class="form-group">
							<label class="control-label col-xs-4">收购金额</label>
							<div class="col-xs-8">
								<input id="oldCarPurchase" name="oldCarPurchase" data-fieldName="OLD_CAR_PURCHASE" 
									class="form-control" type="text" disabled="disabled" />
							</div>
						</div>
					</div>

					<div class="col-xs-12 col-sm-6 col-md-4">
						<div class="form-group">
							<label class="control-label col-xs-4">二手车描述</label>
							<div class="col-xs-8">
								<input id="permutedDesc" name="permutedDesc" class="form-control"
									type="text" disabled="disabled" data-fieldName="PERMUTED_DESC" />
							</div>
						</div>
					</div>
					<div class="col-xs-12 ">
					<div class="col-xs-12 col-sm-6 col-md-4">
							<div class="form-group">
								<label class="control-label col-xs-4">收购协议</label>
								<div class="col-xs-8">
								   <input id="address" name="address" class="form-control"  type="text" />
													
								</div>
							</div>
						</div>
						<div class="col-xs-12 col-sm-6 col-md-4">
							<div class="form-group">
							
								<div class="col-xs-12">
								   <input id="address" name="address" class="form-control"  type="text" />
													
								</div>
							</div>
						</div>
						<div class="col-xs-12 col-sm-6 col-md-4">
							<div class="form-group">
							
								<div class="col-xs-12">
									<a class="btn blue disabled" ><i class="fa fa-minus-square"></i>点击扫描收购协议</a> 
								</div>
							</div>
						</div>
						</div>
                      </div>
					</div>
				</div>
			</div>
		</div>
		<div class="panel panel-default table-panel">
			<div class="panel-body">
				<div class="tabbable-custom">
					<ul class="nav nav-tabs">
						<li class="active"><a href="#tab_decorationProject" data-toggle="tab">装潢项目</a></li>
						<li><a href="#tab_decorationMaterials" data-toggle="tab">精品材料</a></li>
						<li><a href="#tab_serviceProject" data-toggle="tab">服务项目</a></li>
					</ul>
					<div class="tab-content">
						<div class="tab-pane fade in active" id="tab_decorationProject">
							<div class="panel panel-default table-panel">
								<div class="panel-heading">
									<div class="pannel-button">
										<div class="btn-group btn-group-sm">
											<a class="btn btn-outline"
												data-url="retail/ordermanage/salesorder/selectDecoration.html"
												data-toggle="modal" data-width="modal-lg"><i
												class="fa fa-plus-square"></i>添加 </a>
										</div>
									</div>
								</div>
							</div>

							<div class="panel panel-default table-panel">
								<div class="panel-body">
									<table
										class="table table-striped table-bordered table-hover table-responsive"
										id="soDecrodateList">
									</table>
								</div>
							</div>
						</div>
						<div class="tab-pane fade" id="tab_decorationMaterials">
							<div class="panel panel-default table-panel">
								<div class="panel-heading">
									<div class="pannel-button">
										<div class="btn-group btn-group-sm">
											<a class="btn btn-outline"
												data-url="customer/potentialcus/customerInfo/addCusInfo.html"
												data-toggle="modal" data-width="modal-lg"><i
												class="fa fa-plus-square"></i>添加 </a>
										</div>
									</div>
								</div>
							</div>
							<div class="panel panel-default table-panel">
								<div class="panel-body">
									<table
										class="table table-striped table-bordered table-hover table-responsive"
										id="soDecrodatePartList">
									</table>
								</div>
							</div>
						</div>
						<div class="tab-pane fade" id="tab_serviceProject">
							<div class="panel panel-default table-panel">
								<div class="panel-heading">
									<div class="pannel-button">
										<div class="btn-group btn-group-sm">
											<a class="btn btn-outline"
												data-url="retail/ordermanage/salesorder/selectServiceProject.html"
												data-toggle="modal" data-width="modal-lg"><i
												class="fa fa-plus-square"></i>添加 </a>
												
										</div>
									</div>
								</div>
							</div>
							<div class="panel panel-default table-panel">
								<div class="panel-body">
									<table
										class="table table-striped table-bordered table-hover table-responsive"
										id="soServicesList">
									</table>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<div class="panel panel-default" >
			<div class="panel-body" >
				<div class="row">
					<div class="col-xs-12 col-sm-6 col-md-4 col-lg-3" data-tableVINSelect="true" data-tableProductSelect="true">
						<div class="form-group">
							<label class="control-label col-xs-4">车辆价格</label>
							<div class="col-xs-8">
								<input id="vehiclePrice" name="vehiclePrice" maxDigit="12" maxPrecision="2" data-autoValueDigits="2"
									class="form-control decimal" type="text" value="0"  data-fieldName="VEHICLE_PRICE"/>
							<div class="hidden">
								<a data-onclickEvent1="true"></a>
							</div>
							</div>
						</div>
					</div>

					<div class="col-xs-12 col-sm-6 col-md-4 col-lg-3">
						<div class="form-group">
							<label class="control-label col-xs-4">装潢金额</label>
							<div class="col-xs-8">
								<input id="upholsterSum" name="upholsterSum" class="form-control" value="0" data-autoValueDigits="2"
									type="text" disabled="disabled" data-fieldName="UPHOLSTER_SUM"/>
							</div>
						</div>
					</div>

					<div class="col-xs-12 col-sm-6 col-md-4 col-lg-3">
						<div class="form-group">
							<label class="control-label col-xs-4">赠送金额</label>
							<div class="col-xs-8">
								<input id="presentSum" name="presentSum" class="form-control" value="0" data-autoValueDigits="2"
									type="text" disabled="disabled" data-fieldName="PRESENT_SUM"/>
							</div>
						</div>
					</div>

					<div class="col-xs-12 col-sm-6 col-md-4 col-lg-3">
						<div class="form-group">
							<label class="control-label col-xs-4">服务项目金额</label>
							<div class="col-xs-8">
								<input id="serviceSum" name="serviceSum" class="form-control" value="0" data-autoValueDigits="2"
									type="text" disabled="disabled" data-fieldName="SERVICE_SUM"/>
							</div>
						</div>
					</div>

					<div class="col-xs-12 col-sm-6 col-md-4 col-lg-3">
						<div class="form-group">
							<label class="control-label col-xs-4">抵扣金额</label>
							<div class="col-xs-8">
								<input id="offsetAmount" name="offsetAmount" class="form-control decimal"  maxDigit="12" maxPrecision="2" value="0"
									type="text" data-fieldName="OFFSET_AMOUNT" data-autoValueDigits="2" />
							</div>
						</div>
					</div>

					<div class="col-xs-12 col-sm-6 col-md-4 col-lg-3">
						<div class="form-group">
							<label class="control-label col-xs-4">订单总额</label>
							<div class="col-xs-8">
								<input id="orderSum" name="orderSum" class="form-control" value="0"
									type="text" disabled="disabled" data-fieldName="ORDER_SUM"  data-autoValueDigits="2"
									data-autoValue="#vehiclePrice + #upholsterSum + #serviceSum "
									/>
							</div>
						</div>
					</div>

					<div class="col-xs-12 col-sm-6 col-md-4 col-lg-3">
						<div class="form-group">
							<label class="control-label col-xs-4">订单应收</label>
							<div class="col-xs-8">
								<input id="orderReceivableSum" name="orderReceivableSum" value="0"
									class="form-control" type="text" disabled="disabled" data-autoValueDigits="2"
									data-autoValue="#vehiclePrice + #upholsterSum + #serviceSum - #offsetAmount"
									data-fieldName="ORDER_RECEIVABLE_SUM"  />
							</div>
						</div>
					</div>
						<div class="col-xs-12 col-sm-6 col-md-4 col-lg-3">
						<div class="form-group">
							<label class="control-label col-xs-4">其他金额</label>
							<div class="col-xs-8">
								<input id="presentSum" name="presentSum" class="form-control" value="0" data-autoValueDigits="2"
									type="text" disabled="disabled" data-fieldName="PRESENT_SUM"/>
							</div>
						</div>
					</div>
						<div class="col-xs-12 col-sm-6 col-md-4 col-lg-3">
						<div class="form-group">
							<label class="control-label col-xs-4">保险金额</label>
							<div class="col-xs-8">
								<input id="presentSum" name="presentSum" class="form-control" value="0" data-autoValueDigits="2"
									type="text" disabled="disabled" data-fieldName="PRESENT_SUM"/>
							</div>
						</div>
					</div>
					<!--/span-->
					<div class="col-xs-12 col-sm-6 col-md-4 col-lg-3">
						<div class="form-group">
							<label class="control-label col-xs-4">牌照金额</label>
							<div class="col-xs-8">
								<input id="presentSum" name="presentSum" class="form-control" value="0" data-autoValueDigits="2"
									type="text" disabled="disabled" data-fieldName="PRESENT_SUM"/>
							</div>
						</div>
					</div>
					<!--/span-->
					<div class="col-xs-12 col-sm-6 col-md-4 col-lg-3">
						<div class="form-group">
							<label class="control-label col-xs-4">税收金额</label>
							<div class="col-xs-8">
								<input id="presentSum" name="presentSum" class="form-control" value="0" data-autoValueDigits="2"
									type="text" disabled="disabled" data-fieldName="PRESENT_SUM"/>
							</div>
						</div>
					</div>
					<!--/span-->
						<div class="col-xs-12 col-sm-6 col-md-4 col-lg-3">
						<div class="form-group">
							<label class="control-label col-xs-4">代表预收</label>
							<div class="col-xs-8">
								<input id="presentSum" name="presentSum" class="form-control" value="0" data-autoValueDigits="2"
									type="text" disabled="disabled" data-fieldName="PRESENT_SUM"/>
							</div>
						</div>
					</div>
					<!--/span-->
						<div class="col-xs-12 col-sm-6 col-md-4 col-lg-3">
						<div class="form-group">
							<label class="control-label col-xs-4">代办应收</label>
							<div class="col-xs-8">
								<input id="presentSum" name="presentSum" class="form-control" value="0" data-autoValueDigits="2"
									type="text" disabled="disabled" data-fieldName="PRESENT_SUM"/>
							</div>
						</div>
					</div>
					<!--/span-->
					
				</div>
			</div>
		</div>
		<div class="form-actions">
		    <!-- <a data-goback="page"
						data-url="customer/potentialcus/customerInfo/editCusInfo.html"
						data-toggle="modal" data-width="modal-lg" data-beforeShowEvent="true"
						class="btn blue" ><i class="fa fa-plus-square"></i>
						客户信</a> -->
			   <a class="btn blue"   data-beforeShowEvent="true" id="customerInfo"
						data-url="customer/potentialcus/customerInfo/editCusInfo.html" disabled
						data-toggle="modal" data-width="modal-lg"> <i class="fa fa-plus-square"></i>
						客户信息
					</a> 			
						
			  <!-- data-method="POST" data-model="retail" -->
			<a data-url="/ordermanage/salesOrders" data-model="retail" id="saveBtn"
				data-method="POST" data-callBack="true" class="btn blue" data-beforeRequest="true"
				data-toggle="confirmation"><i class="fa fa-save"></i>保存 </a>
			<!-- <div class="hidden">
				<a href="retail/ordermanage/salesorder/editSalesOrder.html"
					class="btn btn-outline ajaxify" data-onclickEvent="true"> <i
					class="fa fa-plus-square"></i> 保存成功后
				</a>
			</div> -->
			<a data-url="/ordermanage/salesOrders" data-model="retail"
				data-method="POST" data-callBack="true" class="btn blue"
				data-toggle="confirmation"><i class="fa fa-save"></i>合约书打印 </a>
				<a data-url="/ordermanage/salesOrders" data-model="retail"
				data-method="POST" data-callBack="true" class="btn blue"
				data-toggle="confirmation"><i class="fa fa-save"></i>缴费通知打印 </a>
				<a data-url="/ordermanage/salesOrders" data-model="retail"
				data-method="POST" data-callBack="true" class="btn blue"
				data-toggle="confirmation"><i class="fa fa-save"></i>打印 </a>
				<a data-url="/ordermanage/salesOrders" data-model="retail"
				data-method="POST" data-callBack="true" class="btn blue"
				data-toggle="confirmation"><i class="fa fa-save"></i>签批单打印 </a>
				
				<!-- <a  data-errorCallBack="true" data-info="saveBefore" data-url="/basedata/employees/employeSaveBefore/{[EMPLOYEE_NO]}" data-callBack="true"   class="btn blue" data-toggle="confirmation" data-model="manage" data-method="GET" ><i class="fa fa-save"></i> 提交审核
			</a>
		<a  data-info="saveBeforeUrl"  data-url="/basedata/employees/{[EMPLOYEE_ID]}" data-model="manage" data-method="PUT"
				 data-saveBeforeEvent="true" class="btn blue ajaxrest hidden" ><i class="fa fa-save"></i> 提交审核</a>  -->
			 <a data-url="/ordermanage/salesorders/submit/checkVerified"
											data-model="manage" data-method="PUT" id="auditBtn" disabled data-beforeRequest="true" data-callBack="true"  data-validate="true"  class="btn blue" 
											 data-toggle="confirmation"><i class="fa fa-save"></i> 提交审核</a> 
      <!--  <a  data-errorCallBack="true" id="btn1" data-info="saveBefore"  data-callBack="true"   class="btn blue" data-toggle="confirmation" data-model="customer" data-method="GET" ><i class="fa fa-save"></i> 确认
			</a>
			<a  data-info="saveBeforeUrl" data-saveBeforeEvent="true" data-onclickEvent="true" class="btn blue ajaxrest hidden" ><i
				class="fa fa-save"></i>确定</a>	 -->										 
			<!-- <a class="btn  blue" disabled="disabled"><i class="fa fa-check-square-o"></i>提交审核</a> -->
			<a data-goback="page"
						data-url="retail/ordermanage/salesorder/searchAuditDetail.html" 
						data-toggle="modal" data-width="modal-lg"
						class="btn blue" ><i class="fa fa-plus-square"></i>
						审核记录</a>
			
			<a data-goback="page" href="retail/ordermanage/salesorder/searchSalesOrder.html"
				class="btn blue ajaxify"><i class="fa fa-reply"></i>返回</a>
		</div>
	</form>
</div>
<script type="text/javascript">
	$(document) .one( "onload.dms", function(event, container) {
		 /* alert(1211);
		 var cusSource=$("#cusSource",container).val();
		 if(cusSource=="13111003"){
			 $("#isPermuted",container).attr("data-fieldName",12781001);
		 } */
		 //金额计算
		 var calcTotalAmount = function(){
			 dmsRetail.moneyCalculate(container);
		 };
		//计算订单总额
		 $("input[name='vehiclePrice']",container).bindChange(function(obj){
			 	$("#vehiclePrice",container).bindAutoValueEvent("");//车辆价格 
				$("#upholsterSum",container).bindAutoValueEvent("");//装潢金额
				$("#serviceSum",container).bindAutoValueEvent("");//服务项目金额
				$("#offsetAmount",container).bindAutoValueEvent("");//抵扣金额
				$("#orderSum",container).bindAutoValueEvent("");//订单总额= 车辆价格+装潢金额+服务项目金额
				$("#orderReceivableSum",container).bindAutoValueEvent("");//订单应收 = 车辆价格+装潢金额+服务项目金额-抵扣金额
				$("#orderSum",container).bindAutoValueEvent("#vehiclePrice + #upholsterSum + #serviceSum");	
				$("#orderReceivableSum",container).bindAutoValueEvent("#vehiclePrice + #upholsterSum + #serviceSum - #offsetAmount");
		});	
		new Datatable() .initLocale({
			src : "soDecrodateList",
			rowID : "SO_DECRODATE_ID",
			container : container,
			checkboxHeader:true, //全选框
			selectItemName:"SO_DECRODATE_ID",
			columns : [
				     {checkbox:true},
					{ field : "SO_DECRODATE_ID", title : "操作", operateFormat : [ { type : "localDel" ,
						onBeforeEvent : function(value, row, index) {
							
							var tab=$("#soDecrodateList tbody");
							var afterDiscountAmount =parseFloat(0);
							var afterDiscountAmount = $("tr:eq("+index+") td:eq(7) input[id^=afterDiscountAmount]",tab).val();
							var upholsterSum = $("#upholsterSum",getElementContext()).val();
							
							if(afterDiscountAmount == 0 || afterDiscountAmount == "" || afterDiscountAmount == undefined){
								var afterDiscountAmount=parseFloat(0);
								$("#upholsterSum",container).setDmsValue(parseFloat(upholsterSum).toFixed(2));
							}else{
								$("#upholsterSum",container).setDmsValue(parseFloat(upholsterSum)-parseFloat(afterDiscountAmount).toFixed(2));
							}
						}} ] },
					{ field : "LABOUR_CODE", inputField : "labourCode", title : "装潢项目代码", inputHiddenFormat : {} },
					{ field : "LABOUR_NAME", inputField : "labourName", title : "装潢项目名称", inputHiddenFormat : {} },
					{ field : "", inputField : "labourName", title : "是否售前装潢", inputHiddenFormat : {} },
					{ field : "", inputField : "labourName", title : "套餐编号", inputHiddenFormat : {} },
					{ field : "REMARK", inputField : "remark", title : "备注", inputHiddenFormat : {},inputTextFormat : {}},
					{ field : "DISCOUNT", inputField : "discount", title : "折扣率", inputHiddenFormat : {},inputNumberFormat : {decimal : 2, defaultValue:1 ,validate:{validateClass:" decimal",validateAttr:'max="1" min ="0" maxPrecision="2"'} } },
					{ field : "AFTER_DISCOUNT_AMOUNT", inputField : "afterDiscountAmount", title : "实收金额", inputHiddenFormat : {}, numberFormat:{decimal : 2,autoValueFormat:{autoValue:"#stdLabourHour*#labourPrice*#discount",afterEvent:calcTotalAmount}} },
					{ field : "", inputField : "labourName", title : "优惠金额", inputHiddenFormat : {} },
					{ field : "LABOUR_PRICE", inputField : "labourPrice", title : "工时单价", inputHiddenFormat : {}, inputNumberFormat : {decimal : 2,validate:{validateClass:" decimal"}}},
					{ field : "STD_LABOUR_HOUR", inputField : "stdLabourHour", title : "标准工时", inputHiddenFormat : {}, NumberFormat : {} }
					

					]
					});
		new Datatable().initLocale({
			src : "soDecrodatePartList",
			rowID : "DECRODATE_PART_ID",
			container : container,
			checkboxHeader:true, //全选框
			selectItemName:"DECRODATE_PART_ID",
			columns : [
				{checkbox:true},
						{ field : "DECRODATE_PART_ID", title : "操作", operateFormat : [ { type : "localDel",
							onBeforeEvent : function(value, row, index) {
								//删除实时金额变更事件
								var tab=$("#soDecrodatePartList tbody");
								var rows=$("tr",tab).length;
								var afterDiscountAmountPartList =parseFloat(0);
								var partSalesAmount =parseFloat(0);
								var accountMode = $("tr:eq("+index+") td:eq(12) select[id^=accountMode]",tab).val();
								var partSalesAmount = $("tr:eq("+index+") td:eq(9) input[id^=partSalesAmount]",tab).val();
								var presentSum = $("#presentSum",getElementContext()).val();
								var afterDiscountAmountPartList = $("tr:eq("+index+") td:eq(11) input[id^=afterDiscountAmountPartList]",tab).val();
								var upholsterSum = $("#upholsterSum",getElementContext()).val();
								if(afterDiscountAmountPartList == 0 || afterDiscountAmountPartList == "" || afterDiscountAmountPartList == undefined){
									var afterDiscountAmountPartList=parseFloat(0);
									$("#upholsterSum",container).setDmsValue(parseFloat(upholsterSum).toFixed(2));
								}else{
									$("#upholsterSum",container).setDmsValue((parseFloat(upholsterSum)-parseFloat(afterDiscountAmountPartList)).toFixed(2));
									}
								if(accountMode == "14061004"){
									if(partSalesAmount == 0 || partSalesAmount == "" || partSalesAmount ==undefined){
										var partSalesAmount = parseFloat(0);
										$("#presentSum",container).setDmsValue(parseFloat(presentSum).toFixed(2));
									}else{
									$("#presentSum",container).setDmsValue((parseFloat(presentSum) - parseFloat(partSalesAmount)).toFixed(2));
									}
								}
							}}] },
						
							{ field : "STORAGE_NAME", inputField : "storageCode", title : "仓库代码", inputHiddenFormat : {hiddenField:"STORAGE_CODE"}},
							{ field : "STORAGE_POSITION_CODE", inputField : "storagePositionCode", title : "库位代码", inputHiddenFormat : {} },
							{ field : "PART_CODE", inputField : "partNo", title : "配件代码", inputHiddenFormat : {} },
							{ field : "PART_NAME", inputField : "partName", title : "配件名称", inputHiddenFormat : {} },
							{ field : "", inputField : "labourName", title : "计量单位", inputHiddenFormat : {} },
							{ field : "SALES_PRICE", inputField : "partSalesPrice", title : "配件销售单价", inputHiddenFormat : {decimal : 2}},
						    { field : "", inputField : "labourName", title : "配件实际销售单价", inputHiddenFormat : {} },
						    { field : "PART_QUANTITY", inputField : "partQuantity", title : "数量",inputNumberFormat : {validate:{validateClass:"required digits",validateAttr:' min ="1" '}}, inputHiddenFormat : {}},
						    { field : "ACCOUNT_MODE", inputField : "accountMode", title : "结算方式",  inputHiddenFormat : {}, inputSelectFormat : {type : "dict", codeType : "1406",defaultValue:"14061002",validate:{validateClass:"required"},attr:"data-excludeItems='14061001'"}},
						    { field : "DISCOUNT", inputField : "discount2", title : "折扣率",inputNumberFormat : {decimal : 2, defaultValue:1,validate:{validateClass:" decimal",validateAttr:'max="1" min ="0" maxPrecision="2"'} }, inputHiddenFormat : {}},
						    { field : "PART_SALES_AMOUNT", inputField : "partSalesAmount", title : "配件实际销售金额", inputHiddenFormat : {}, numberFormat:{decimal : 2,autoValueFormat:{autoValue:"#partSalesPrice*#partQuantity"}}},
						    { field : "", inputField : "labourName", title : "是否售前装潢", inputHiddenFormat : {} },
						    { field : "", inputField : "labourName", title : "套餐编号", inputHiddenFormat : {} },
						    { field : "REMARK", inputField : "remark", title : "备注",inputTextFormat : {}}
						]
					});
		new Datatable().initLocale({
			src : "soServicesList",
			rowID : "SERVICE_ID",
			container : container,
			checkboxHeader:true, //全选框
			selectItemName:"SERVICE_ID",
			columns : [
				{checkbox:true},
					{ field : "SERVICE_ID", title : "操作", operateFormat : [ { type : "localDel",
						onBeforeEvent : function(value, row, index) {
							var tab=$("#soServicesList tbody");
							var rows=$("tr",tab).length;
							var directivePrice =parseFloat(0);//销售指导价
							var afterDiscountAmountServicesList =parseFloat(0);//实收金额
							var directivePrice = $("tr:eq("+index+") td:eq(5) input[id^=directivePrice]",tab).val();
							var afterDiscountAmountServicesList = $("tr:eq("+index+") td:eq(6) input[id^=afterDiscountAmountServicesList]",tab).val();
							var accountModeList = $("tr:eq("+index+") td:eq(7) select[id^=accountModeList]",tab).val();
							var serviceSum = $("#serviceSum",getElementContext()).val();
							var presentSum = $("#presentSum",getElementContext()).val();
							if(accountModeList == "14061004"){
								$("#presentSum",container).setDmsValue((parseFloat(presentSum)-parseFloat(directivePrice)).toFixed(2));
							}
							if(afterDiscountAmountServicesList == 0 || afterDiscountAmountServicesList == "" || afterDiscountAmountServicesList == undefined){
								var afterDiscountAmountServicesList =parseFloat(0);
								$("#serviceSum",container).setDmsValue((parseFloat(serviceSum)).toFixed(2));
							}else{
								$("#serviceSum",container).setDmsValue((parseFloat(serviceSum)-parseFloat(afterDiscountAmountServicesList)).toFixed(2));
							}
						}}] },
					{ field : "SERVICE_CODE", inputField : "serviceCode", title : "服务项目代码", inputHiddenFormat : {} },
					{ field : "SERVICE_NAME", inputField : "serviceName", title : "服务项目名称", inputHiddenFormat : {} },
					{ field : "SERVICE_TYPE", inputField : "serviceType", title : "服务类别", inputHiddenFormat : {} , codeFormat : { type : "dict", codeType : "1402" } },
					{ field : "DIRECTIVE_PRICE", inputField : "directivePrice", title : "销售指导价", inputHiddenFormat : {} ,numberFormat : {decimal : 2,autoValueFormat:{autoValue:"",afterEvent:calcTotalAmount}} },
					{ field : "DIRECTIVE_PRICE", inputField : "afterDiscountAmountServicesList", title : "实收销售价", inputHiddenFormat : {}, inputNumberFormat : {decimal : 2,validate:{validateClass:" decimal"},autoValueFormat:{autoValue:"#directivePrice",afterEvent:calcTotalAmount}} },
					{ field : "ACCOUNT_MODE", inputField : "accountModeList", title : "结算方式", inputHiddenFormat : {},inputSelectFormat : { type : "dict", codeType : "1406" ,defaultValue:"14061002",validate:{validateClass:"required"}} },
					{ field : "", inputField : "labourName", title : "实际发生金额", inputHiddenFormat : {} },
					{ field : "", inputField : "labourName", title : "代办预收金额", inputHiddenFormat : {} },
					{ field : "", inputField : "labourName", title : "套餐编号", inputHiddenFormat : {} },
					{ field : "REMARK", inputField : "remark", title : "备注", inputHiddenFormat : {},inputTextFormat : {}}
					]
					});	
		$("#cusSource",container).bindChange(function(obj){
			 var cusSource=$("#cusSource",container).val();
			 if(cusSource=="13111020"){
				  $("#isPermuted",container).val("12781001"); 
				  $("#permutedVin",container).removeAttr("disabled");
				  $("#permutedVin",container).addClass("required");
				  $("#oldCarPurchase",container).removeAttr("disabled");
				  $("#oldCarPurchase",container).addClass("required");
				  $("#permutedDesc",container).removeAttr("disabled");
			 }else{
				 $("#oldCarPurchase",container).attr("disabled","disabled");
				 $("#oldCarPurchase",container).removeClass("required");
				 $("#permutedVin",container).attr("disabled","disabled");
				 $("#permutedVin",container).removeClass("required");
				 $("#permutedDesc",container).attr("disabled","disabled");
				 $("#isPermuted",container).val("");
				 $("#oldCarPurchase",container).val("");
			 }
		});
		
		$("#customerNo",container).bindChange(function(obj){
			var customerNo=$("#customerNo",container).val();
			if(customerNo!=null&&customerNo!=undefined){
				  $("#customerInfo",container).removeAttr("disabled");

			 }else{
				 $("#customerInfo",container).attr("disabled","disabled"); 
			 }
		});
		$("#payMode",container).bindChange(function(obj){
			var payMode=$("#payMode",container).val();
			if(payMode=="10251003"){
				  $("#allLoanRate",container).removeAttr("disabled");
				  $("#loanOrg",container).removeAttr("disabled");
				  $("#firstPermentRangeS",container).removeAttr("disabled");
				  $("#firstPermentRangeE",container).removeAttr("disabled");
				  $("#loanRate",container).removeAttr("disabled");
				  $("#firstPermentRatio",container).removeAttr("disabled");
				  $("#installmentAmount",container).removeAttr("disabled");
				  $("#installmentNumber",container).removeAttr("disabled");
			 }else{
				 $("#allLoanRate",container).attr("disabled","disabled"); 
				 $("#loanOrg",container).attr("disabled","disabled"); 
				 $("#loanOrg",container).val("");
				 $("#firstPermentRangeS",container).attr("disabled","disabled"); 
				 $("#firstPermentRangeS",container).val("");
				 $("#firstPermentRangeE",container).attr("disabled","disabled"); 
				 $("#firstPermentRangeE",container).val("");
				 $("#loanRate",container).attr("disabled","disabled"); 
				 $("#loanRate",container).val("");
				 $("#firstPermentRatio",container).attr("disabled","disabled"); 
				 $("#firstPermentRatio",container).val("");
				 $("#installmentAmount",container).attr("disabled","disabled"); 
				 $("#installmentAmount",container).val("");
				 $("#installmentNumber",container).attr("disabled","disabled"); 
				 $("#installmentNumber",container).val("");
			 }
		});
		$("#soNo",container).bindChange(function(obj){
			var soNo=$("#soNo",container).val();
			if(soNo!=null){
				 $("#auditBtn",container).removeAttr("disabled");
			 }
		});
		$("#isPermuted",container).bindChange(function(obj){
			var isPermuted=$("#isPermuted",container).val();
			if(isPermuted=="12781001"){
				  $("#permutedVin",container).removeAttr("disabled");
				  $("#permutedVin",container).addClass("required");
				  $("#oldCarPurchase",container).removeAttr("disabled");
				  $("#oldCarPurchase",container).addClass("required");
				  $("#permutedDesc",container).removeAttr("disabled");
			 }else{
				 $("#oldCarPurchase",container).attr("disabled","disabled");
				 $("#oldCarPurchase",container).removeClass("required");
				 $("#permutedVin",container).attr("disabled","disabled");
				 $("#permutedVin",container).removeClass("required");
				 $("#permutedDesc",container).attr("disabled","disabled");
				 $("#oldCarPurchase",container).val("");
			 }
		});
		
		$("a[data-beforeRequest='true']",container).on('beforeRequest.dms',function(event,returnResult){
			alert(1211)
			   var falg=0;
			   if(event.target.id=='auditBtn'){
				 confirm("官网订单提交后不能修改,确认提交?",function(confirmObj){
					$(confirmObj).click();
					 alert(1)
					    falg=1;
							},function(confirmObj){
								alert(12)
								  falg=2;
								
							});
			    }
				if(event.target.id=='saveBtn'){
					alert(1211)
					var vin=$("#vin",container).val();
					var isPermuted=$("#isPermuted",container).val();
					var permutedVin=$("#permutedVin",container).val();
					var oldCarPurchase=$("#oldCarPurchase",container).val();
					var vehiclePrice=$("#vehiclePrice",container).val();
					var deliveryModeElec=$("#deliveryModeElec",container).val(); 
					
					if(isPermuted=="12781001"){
						if(permutedVin==null||permutedVin==undefined){
							dmsCommon.tip({status:"warning",msg:"置换车VIN不能为空!"});
							returnResult.status = false;
							return ;
						}
						if(oldCarPurchase==null||permutedVin==undefined||oldCarPurchase==0||oldCarPurchase==""){
							dmsCommon.tip({status:"warning",msg:"必须填写收购金额!"});
							returnResult.status = false;
							return ;
						}
					}
					if(vehiclePrice==null||vehiclePrice==undefined||vehiclePrice==""||vehiclePrice==0){
						dmsCommon.tip({status:"warning",msg:"必须填写车辆价格!"});
						returnResult.status = false;
						return ;
					}
					if(vin==null||vin==undefined||vin==""){
						if(deliveryModeElec==16001001){
							dmsCommon.tip({status:"warning",msg:"现车资源VIN不能为空!"});
							returnResult.status = false;
							return ;
						}
					}else{
						if(deliveryModeElec==16001002){
							dmsCommon.tip({status:"warning",msg:"CALL车不能选择VIN码!"});
							returnResult.status = false;
							return ;
						}
					}
				}
			if(falg==1){
				returnResult.status = true;		
			}
			if(falg==2){
				returnResult.status = false;
				return ;
			}
			returnResult.status = true;
	    });

			//弹出页面打开前执行函数
		$("a[data-beforeShowEvent='true']",container).on("beforeShow.dms",function(event,returnResult){
			    var config=$("#config",container).val();
			    var customerNo=$("#customerNo",container).val();
			    if(event.target.id=='allLoanRate'){
			    	if(config==null||config==undefined){
						dmsCommon.tip({status:"warning",msg:"请单择配置！"});
						returnResult.status = false;
						return ;
					}
			    }
			    if(event.target.id=='customerInfo'){
			    	if(customerNo!=null){
						$(this).data("pageData",{CUSTOMER_NO:customerNo});
					}
			    }
				returnResult.status = true;
		/* 	var customerNo=$("#customerNo",container).val();
				alert(customerNo);
			alert(11111);
				if(customerNo==null||customerNo==undefined){
					dmsCommon.tip({status:"warning",msg:"请选择客户！"});
					returnResult.status = false;
					return ;
				} */
				/* $(container).data("pageData",{CUSTOMER_NO:customerNo}); */
		          /* dmsCommon.refreshPageByUrl("customer/potentialcus/customerInfo/editCusInfo.html",container); */
				returnResult.status = true;
			});
		 
	/* 	 $("a[data-beforeShowEvent='true']",container).on("beforeShow.dms",function(event,returnResult){
				var customerNo=$("#customerNo",container).val();
				alert(11111)
					if(customerNo==null||customerNo==undefined){
						dmsCommon.tip({status:"warning",msg:"请选择客户！"});
						returnResult.status = false;
						return ;
					}
					$(container).data("pageData",{CUSTOMER_NO:customerNo});
			          dmsCommon.refreshPageByUrl("customer/potentialcus/customerInfo/editCusInfo.html",container);
					returnResult.status = true;
				}); */
		//绑定事件
	 	$("a[data-callBack='true']", container).on( "callBack.dms", function(event, response) {
	 	/* 	if(event.target.id=='btn1'){
	 			$("a[data-info='saveBefore']",container).addClass("hidden");
				$("a[data-info='saveBeforeUrl']",container).click();
				$("a[data-info='saveBefore']",container).removeClass("hidden");
				$("a[data-info='saveBeforeUrl']",container).addClass("hidden");
				var confirmPostBO=$("a[data-info='saveBeforeUrl']",container);
				if(response.success=="true"){
					$("a[data-info='saveBeforeUrl']",container).click();
					$("a[data-info='saveBefore']",container).removeClass("hidden");
					$("a[data-info='saveBeforeUrl']",container).addClass("hidden");
				}else{
					confirmPostBO.confirm("已存在同一政策类别、同一公司的报备单，您确定继续保存?",function(confirmObj){
						$(confirmObj).click();
						$("a[data-info='saveBefore']",container).removeClass("hidden");
						$("a[data-info='saveBeforeUrl']",container).addClass("hidden");
						},function(confirmObj){
							$("a[data-info='saveBefore']",container).removeClass("hidden");
							$("a[data-info='saveBeforeUrl']",container).addClass("hidden");
						}
					);
				}
	 		} */
	 		if(event.target.id=='saveBtn'){
	 			$("#soNo",container).setDmsValue(response.SO_NO);
	 		/* 	if(response.SO_NO!=null){
	 				 $("#auditBtn",container).removeAttr("disabled");
	 			} */
	 		}
	 		        
					/* $("a[data-onclickEvent='true']", container).data("pageData", response);
					$("a[data-onclickEvent='true']", container).click(); */
				}); 
		//绑定onchange 事件
		$("a[data-onclickEvent='true']",container).on("dms.click",function(obj){
	
	       /*  dmsCommon.refreshPageByUrl("customer/potentialcus/customerInfo/editCusInfo.html",container);  */
				 changeFormal(obj); 
			});
		});	
</script>