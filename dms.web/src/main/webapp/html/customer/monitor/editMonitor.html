<div class="dms-edit ajaxrest">
	<form class="form-horizontal">
		<div class="modal-header">
			<div class="modal-title">监控车主车辆编辑</div>
			<div class="modal-close">
				<a data-dismiss="modal" class="btn btn-lg"> <i class="fa fa-remove"></i></a>
			</div>
		</div>
		<div class="modal-body">
			<div class="tabbable-retail ">
				<div class="tab-content">
					<div class="tab-pane fade in active" id="tab_basreceive">
						<div class="panel-body" data-tableRetailSelect="true">
							<div class="row">
								<!--/span-->
								<div class="col-xs-12 col-sm-6">
									<div class="form-group">
										<label class="control-label col-xs-2">车牌号</label>
										<div class="col-xs-10">
											<input type="hidden" id="monitorId" name="monitorId" value="{[MONITOR_ID]}"/>
											<input type="text" class="form-control" id="license" name="license" data-fieldName="LICENSE" value="{[LICENSE]}">
										</div>
									</div>
								</div>
								<!--/span-->
								<div class="col-xs-12 col-sm-6">
									<div class="form-group">
										<label class="control-label col-xs-3">车主编号</label>
 										<div class="col-xs-9">
											<div class="input-group">
												<input id="ownerNo" name="ownerNo" data-fieldName="OWNER_NO" value="{[OWNER_NO]}" readonly="readonly" class="form-control" type="text" />
												<span class="input-group-btn">
													<button class="btn default btn-sm" type="button"
														data-url="customer/monitor/searchVehicleOwner.html"
														data-toggle="modal" data-width="modal-lg">
														<i class="fa fa-sitemap"></i>
													</button>
													<button class="btn default input-clear" type="button">
														<i class="fa fa-close"></i>
													</button>
												</span>
											</div>
										</div>
									</div>
								</div>
								<!--/span-->
								<div class="col-xs-12 col-sm-6">
									<div class="form-group">
										<label class="control-label col-xs-2">发动机号</label>
										<div class="col-xs-10">
											<input type="text" class="form-control" id="engineNo" value="{[ENGINE_NO]}" name="engineNo" data-fieldName="ENGINE_NO">
										</div>
									</div>
								</div>
								<!--/span-->
								<div class="col-xs-12 col-sm-6">
									<div class="form-group">
										<label class="control-label col-xs-3">车主</label>
										<div class="col-xs-9">
											<input type="text" class="form-control" id="ownerName" name="ownerName" value="{[OWNER_NAME]}" data-fieldName="OWNER_NAME">
										</div>
									</div>
								</div>
								<!--/span-->
								<div class="col-xs-12 col-sm-6">
									<div class="form-group">
										<label class="control-label col-xs-2">VIN</label>
										<div class="col-xs-10">
											<input type="text" class="form-control" id="vin" name="vin" data-fieldName="VIN" value="{[VIN]}" >
										</div>
									</div>
								</div>
								<!--/span-->
								<div class="col-xs-12 col-sm-6">
									<div class="form-group">
										<label class="control-label col-xs-3">销售日期</label>
										<div class="col-xs-9">
											<div class="input-group date date-picker">
												<input type="text" class="form-control" readonly="readonly" data-fieldName="SALES_DATE_BEGIN" value="{[SALES_DATE_BEGIN]}" name="salesDateBegin" id="salesDateBegin" value="">
												<span class="input-group-addon">至</span>
												<input type="text" class="form-control" readonly="readonly" data-fieldName="SALES_DATE_END" value="{[SALES_DATE_END]}" name="saledDateEnd" id="saledDateEnd" value="">
												<span class="input-group-btn">
													<button class="btn default input-clear" type="button" disabled="disabled">
														<i class="fa fa-close"></i>
													</button>
												</span>
									    	</div> 
										</div>
										</div>
									</div>
								<!--/span-->
								<div class="col-xs-12 col-sm-6">
									<div class="form-group">
										<label class="control-label col-xs-2">后6位VIN</label>
										<div class="col-xs-10">
											<div class="input-group">
												<input type="text" class="form-control digits" data-fieldName="VIN_BEGIN_RANGE" value="{[VIN_BEGIN_RANGE]}" id="vinBeginRange" name="vinBeginRange" /> 
												<span class="input-group-addon">至</span> 
												<input type="text" class="form-control digits" data-fieldName="VIN_END_RANGE" value="{[VIN_END_RANGE]}" id="vinEndRange" name="vinEndRange" />
											</div>
										</div>
									</div>
								</div>
								<!--/span-->
								<div class="col-xs-12 col-sm-6">
									<div class="form-group">
										<label class="control-label col-xs-3">建档日期</label>
										<div class="col-xs-9">
											<div class="input-group date date-picker">
												<input type="text" class="form-control" readonly="readonly" name="foundDate" id="foundDate" data-fieldName="FOUND_DATE" value="{[FOUND_DATE]}">
												<span class="input-group-btn">
													<button class="btn default input-clear" type="button">
														<i class="fa fa-close"></i>
													</button>
												</span>
											</div>
										</div>
									</div>
								</div>
								<!--/span-->
								<div class="col-xs-12 col-sm-6">
									<div class="form-group">
										<label class="control-label col-xs-2">消费额区间</label>
										<div class="col-xs-10">
											<div class="input-group">
												<input type="text" class="form-control digits" data-fieldName="OWNER_CONSUME_AMOUNT_MIN" value="{[OWNER_CONSUME_AMOUNT_MIN]}" id="ownerConsumeAmountMin" name="ownerConsumeAmountMin" value="0.00" /> 
												<span class="input-group-addon">至</span>
												<input type="text" class="form-control" data-fieldName="OWNER_CONSUME_AMOUNT_MAX" value="{[OWNER_CONSUME_AMOUNT_MAX]}" id="ownerConsumeAmountMax" name="ownerConsumeAmountMax" value="0.00" />
											</div>
										</div>
									</div>
								</div>
								<!-- /span -->
								<div class="row">
									<div class="col-xs-12">
										<div class="form-group">
											<label class="control-label col-sm-1">提示信息</label>
											<div class="col-xs-11">
												<input type="text" class="form-control required" value="{[MESSAGE]}" id="message" name="message" data-fieldName="MESSAGE">
											</div>
										</div>
									</div>
								</div>
								<!--/span-->
								<div class="col-xs-12 col-sm-6">

									<div class="form-group">
										<label class="control-label col-xs-2">有效期从</label>
										<div class="col-xs-10">
											<div class="input-group input-daterange">
												<input type="text" class="form-control required" data-fieldName="BEGIN_DATE" readonly name="beginDate" id="beginDate" value="{[BEGIN_DATE]}">
												<span class="input-group-addon">至</span>
												<input type="text" class="form-control required" data-fieldName="END_DATE" readonly name="endDate" id="endDate" value="{[END_DATE]}">
												<span class="input-group-btn">
													<button class="btn default input-clear" type="button">
														<i class="fa fa-close"></i>
													</button>
												</span>
											</div>
										</div>
									</div>
								</div>
								<!--/span-->
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<div class="panel panel-default table-panel">
			<div class="panel-body">
				<table
					class="table table-striped table-bordered table-hover table-responsive"
					id="dms_monitor">
				</table>
			</div>
		</div>
		<div class="modal-footer center-block">
			<a data-url="/customer/monitor/{[MONITOR_ID]}" data-callBack="true" data-model="customer" data-method="PUT" data-callBack="true" class="btn blue" data-toggle="confirmation"><i class="fa fa-save"></i>保存</a> 
			<a data-dismiss="modal" class="btn blue"><i class="fa fa-undo"></i>取消</a>
			<a id="dms_monitorlist" data-onclickEvent="true" data-callBack="true" class="btn blue" ><i class="fa fa-search"></i>历史信息</a> 
		</div>
	</form>
</div>
<script type="text/javascript">
$(document).one("onload.dms",function(event,container){
	
	$("#dms_monitor",container).hide();
		new Datatable().initPagination({
			src : "dms_monitor",
			container:container,
			rowID:"MONITOR_ID",
			undefinedText : "",
			pageSize:5,
			autoHeight:false,
			columns : [ 
				{field : "REPAIR_ORDER_TAG",title : "接待提醒",codeFormat : {type : "dict",codeType : "1278"}},
				{field : "BALANCE_TAG",title : "结算提醒",codeFormat : {type : "dict",codeType : "1278"}},
				{field : "BOOKING_TAG",title : "预约提醒",codeFormat : {type : "dict",codeType : "1278"}},
				{field : "LICENSE",title : "车牌号"},
				{field : "VIN",title : "VIN"},
				{field : "ENGINE_NO",title : "发动机号"},
				{field : "OWNER_NO",title : "车主编号"},
				{field : "OWNER_NAME",title : "车主"},
				{field : "MESSAGE",title : "提示信息"},
				{field : "BEGIN_DATE",title : "开始日期",dateFormat : {format : "YYYY-MM-DD"}},
				{field : "END_DATE",title : "结束日期",dateFormat : {format : "YYYY-MM-DD HH:mm:ss"}},
				{field : "OPERATOR",title : "操作员"},
				{field : "FOUND_DATE",title : "建档日期",dateFormat : {format : "YYYY-MM-DD HH:mm:ss"}},
	         ],
		});
		
		$("a[data-onclickEvent='true']",container).on("dms.click",function(event){
			$("#dms_monitor",container).show();
			dmsCommon.ajaxRestRequest({
				url:dmsCommon.getDmsPath()["customer"] +"/customer/monitor/historyMonitor",
				type:"GET",
				sucessCallBack : function(data) {
					
				}
			});
		});
		
		//新增页面回调函数
		$("a[data-callBack='true']", container).on("callBack.dms",
			function(event, response) {
			//关闭窗口
			$("a[data-dismiss='modal']", container).click();
			//刷新表格
			$("#dms_monitor", getElementContext()).dmsTable().refreshTableWithForm();
		});
});
</script>