<div class="dms-add">
	<form class="form-horizontal" data-tableSelect="true">
		<div class="modal-header">
			<div class="modal-title">服务活动新增</div>
			<div class="modal-close">
				<a data-dismiss="modal" class="btn btn-lg"> <i
					class="fa fa-remove"></i></a>
			</div>
		</div>
		<div class="panel panel-default">
			<div class="panel-body">
				<div class="row">
					<div class="col-xs-12 col-sm-6 col-md-4  col-lg-3">
						<div class="form-group">
							<label class="control-label col-xs-4">活动代码</label>
							<div class="col-xs-8">
								<input id="activityCode" name="activityCode" data-fieldName="ACTIVITY_CODE"
									class="form-control required" maxlength="15"
									type="text" />
							</div>
						</div>
					</div>
					<div class="col-xs-12 col-sm-6 col-md-4  col-lg-3">
						<div class="form-group">
							<label class="control-label col-xs-4">活动名称</label>
							<div class="col-xs-8">
								<input id="activityName" name="activityName" maxlength="120" data-fieldName="ACTIVITY_NAME"
									class="form-control required" type="text" />
							</div>
						</div>
					</div>
					<div class="col-xs-12 col-sm-12 col-md-8 col-lg-6">
						<div class="form-group">
							<label class="control-label col-xs-4 col-sm-2">开始日期</label>
							<div class="col-xs-8 col-sm-10">
								<div class="input-group date date-picker" date-dateFormat="yyyy-MM-dd">
		                             <input type="text" class="form-control" readonly  name="beginDateFrom" data-fieldName="BEGIN_DATE">
		                             <span class="input-group-addon">至</span>
		                             <input type="text" class="form-control" readonly  name="beginDateTo" data-fieldName="END_DATE"> 
		                              <span class="input-group-btn">
                                         <button class="btn default input-clear" type="button">
                                            <i class="fa fa-close"></i>
                                        </button>
                                      </span> 
		                        </div>
							</div>
						</div>
					</div>
					<div class="col-xs-12 col-sm-6 col-md-3">
						<div class="form-group">
							<label class="control-label col-xs-4">品牌</label>
							<div class="col-xs-8">
								<select id="brand" name="brand" data-ajaxSync="true" data-fieldName="BRAND"
									class="bs-select form-control" data-url="/basedata/brandsdict"
									data-model="manage" data-labelValue="BRAND_CODE"
									data-lableDesc="BRAND_NAME">
								</select>
							</div>
						</div>
					</div>
					<div class="col-xs-12 col-sm-6 col-md-3 ">
						<div class="form-group">
							<label class="control-label col-xs-4">车系</label>
							<div class="col-xs-8">
								<select id="series" class="bs-select form-control" name="series" 
									data-url="/basedata/selectSeries" data-model="customer" data-fieldName="BRAND"
									data-labelValue="SERIES_CODE" data-fieldName="SERIES"
									data-lableDesc="SERIES_NAME" data-alwaysRefresh="true">
								</select>
							</div>
						</div>
					</div>
					<div class="col-xs-12 col-sm-6 col-md-3 ">
						<div class="form-group">
							<label class="control-label col-xs-4">车型</label>
							<div class="col-xs-8">
								<select id="model" class="bs-select form-control" name="model"
									data-url="/basedata/selectModel" data-model="customer" data-fieldName="MODEL"
									data-labelValue="MODEL_CODE" data-fieldName="MODEL"
									data-lableDesc="MODEL_NAME" data-alwaysRefresh="true">
								</select>
							</div>
						</div>
					</div>
					<div class="col-xs-12 col-sm-6 col-md-3 ">
						<div class="form-group">
							<label class="control-label col-xs-4">配置</label>
							<div class="col-xs-8">
								<select id="apAckAge" class="bs-select form-control"
									name="apAckAge" data-ajaxSync="true" data-fieldName="CONFIG_CODE"
									data-url="/basedata/selectConfig" data-model="manage"
									data-labelValue="CONFIG_CODE" data-lableDesc="CONFIG_NAME">
								</select>
							</div>
						</div>
					</div>
					<div class="col-xs-12 col-sm-6 col-md-6">
						<div class="form-group" >
							<label class="control-label col-xs-4">销售日期</label>
							<div class="col-xs-8">
								<div class="input-group input-daterange" data-date-format="yyyy/mm/dd"
									data-opens="right">
									<input type="text" class="form-control" readonly name="salesDateBegin">
										<span class="input-group-addon">至</span> 
									<input type="text" class="form-control" readonly name="salesDateEnd"> 
										<span class="input-group-btn">
										<button class="btn default input-clear" type="button">
											<i class="fa fa-close"></i>
										</button>
									</span>
								</div>
							</div>
						</div>
					</div>
					<div class="col-xs-12 col-sm-6 col-md-3">
						<div class="form-group">
							<label class="control-label col-xs-4">行驶里程</label>
							<div class="col-xs-8">
								<div class="input-group">
									<input type="text" class="form-control decimal number" maxDigit="8" data-fieldName="MILEAGE_BEGIN"
										maxPrecision="2" name="mileageBegin" id="mileageBegin"> <span
										class="input-group-addon">至</span> 
									<input type="text" data-fieldName="MILEAGE_END" id="mileageEnd"
										class="form-control decimal number" maxDigit="8" maxPrecision="2"
										name="mileageEnd">
								</div>
							</div>
						</div>
					</div>
					<div class="col-xs-12 col-sm-6 col-md-3">
						<div class="form-group">
							<label class="control-label col-xs-4">活动总金额</label>
							<div class="col-xs-8">
								<input type="text" name="labourAmount" id="labourAmount" value="0"> 
								<input type="hidden" name="partAmount" id="partAmount" value="0"> 
								<input type="hidden" name="addItemAmount" id="addItemAmount" value="0"> 
								<input id="activityAmount" disabled="disabled" name="activityAmount"
									readonly data-fieldName="ACTIVITY_AMOUNT"
									data-autoValue="#labourAmount+#partAmount+#addItemAmount"
									data-autoValueDigits="2" class="form-control money" type="text" />
							</div>
						</div>
					</div>
					<div class="col-xs-12 col-sm-6 col-md-3">
						<div class="form-group">
							<label class="control-label col-xs-4">活动类别</label>
							<div class="col-xs-8">
								<select id="activityKind" name="activityKind" data-fieldName="ACTIVITY_KIND"
									class="bs-select form-control" data-dictCode="2206"
									data-value="">
								</select>
							</div>
						</div>
					</div>
					<div class="col-xs-12 col-sm-6 col-md-3">
						<div class="form-group">
							<label class="control-label col-xs-4">车辆用途</label>
							<div class="col-xs-8">
								<select id="vehiclePurpose" name="vehiclePurpose" data-fieldName="VEHICLE_PURPOSE"
									class="bs-select form-control" data-dictCode="2200"
									data-value="">
								</select>
							</div>
						</div>
					</div>
					<div class="col-xs-12 col-sm-6 col-md-3">
						<div class="form-group">
							<label class="control-label col-xs-6">是否活动优先</label>
							<div class="col-xs-6">
								<select id="activityFirst" name="activityFirst" data-fieldName="ACTIVITY_FIRST"
									class="bs-select form-control" data-dictCode="1278"
									data-value="">
								</select>
							</div>
						</div>
					</div>
					<div class="col-xs-12 col-sm-6 col-md-3">
						<div class="form-group">
							<label class="control-label col-xs-6">配件是否可编辑</label>
							<div class="col-xs-6">
								<select id="partsIsModify" name="partsIsModify" data-fieldName="PARTS_IS_MODIFY"
									class="bs-select form-control" data-dictCode="1278"
									data-value="">
								</select>
							</div>
						</div>
					</div>
					<div class="col-xs-12 col-sm-6 col-md-3">
						<div class="form-group">
							<label class="control-label col-xs-6">是否配件活动</label>
							<div class="col-xs-6">
								<select id="isPartActivity" name="isPartActivity" data-fieldName="IS_PART_ACTIVITY"
									class="bs-select form-control" data-dictCode="1278"
									data-value="">
								</select>
							</div>
						</div>
					</div>
					<div class="col-xs-12 col-sm-6 col-md-3">
						<div class="form-group">
							<label class="control-label col-xs-6">是否可多次参加活动</label>
							<div class="col-xs-6">
								<select id="isRepeatAttend" name="isRepeatAttend" data-fieldName="IS_REPEAT_ATTEND"
									class="bs-select form-control" data-dictCode="1278" data-value="12781001"
									data-value="">
								</select>
							</div>
						</div>
					</div>
					<div class="col-xs-12 col-sm-6 col-md-3">
						<div class="form-group">
							<label class="control-label col-xs-4">会员卡级别</label>
							<div class="col-xs-8">
								<select id="memberLevelAllowed" name="memberLevelAllowed" data-fieldName="MEMBER_LEVEL_ALLOWED"
									class="bs-select form-control" data-dictCode="2207"
									data-value="">
								</select>
							</div>
						</div>
					</div>
					<div class="col-xs-12 col-sm-6 col-md-3">
						<div class="form-group">
							<label class="control-label col-xs-4">业务类型</label>
							<div class="col-xs-8">
								<select id="businessType" name="businessType" data-fieldName="BUSINESS_TYPE"
									class="bs-select form-control" data-dictCode="1394"
									data-value="">
								</select>
							</div>
						</div>
					</div>
					<div class="col-xs-12 col-sm-6 col-md-3">
						<div class="form-group">
							<label class="control-label col-xs-6">会员积分系数</label>
							<div class="col-xs-6">
								<input id="creditTimes" name="creditTimes" class="form-control" data-fieldName="ACTIVITY_COUNT"
									type="text" value="1.0" /> <span class="input-group-btn">
							</div>
						</div>
					</div>
					<div class="col-xs-12 col-sm-6 col-md-6">
						<div class="form-group" >
							<label class="control-label col-xs-4">保养日期</label>
							<div class="col-xs-8">
								<div class="input-group input-daterange" data-date-format="yyyy/mm/dd"
									data-opens="right">
									<input type="text" class="form-control" readonly name="maintainBeginDay">
										<span class="input-group-addon">至</span> 
									<input type="text" class="form-control" readonly name="maintainEndDay"> 
										<span class="input-group-btn">
										<button class="btn default input-clear" type="button">
											<i class="fa fa-close"></i>
										</button>
									</span>
								</div>
							</div>
						</div>
					</div>
					<div class="col-xs-12 col-sm-6 col-md-3">
						<div class="form-group">
							<label class="control-label col-xs-4">活动性质</label>
							<div class="col-xs-8">
								<select id="activityProperty" name="activityProperty" data-fieldName="ACTIVITY_PROPERTY"
									class="bs-select form-control" data-dictCode="2207"
									data-value="">
								</select>
							</div>
						</div>
					</div>
					<div class="col-xs-12 col-sm-6 col-md-3">
						<div class="form-group">
							<label class="control-label col-xs-4">年款</label>
							<div class="col-xs-8">
								<input id="modelYear" name="modelYear" class="form-control" data-fieldName="MODEL_YEAR"
									type="text" />
							</div>
						</div>
					</div>
					<div class="col-xs-12 col-sm-6 col-md-3">
						<div class="form-group">
							<label class="control-label col-xs-6">全球活动编号</label>
							<div class="col-xs-6">
								<input id="globalActivityCode" name="globalActivityCode"
									maxlength="100" class="form-control systemCode" type="text" />
							</div>
						</div>
					</div>
					<div class="col-xs-12 col-sm-12 col-md-8 col-lg-6">
						<div class="form-group">
							<label class="control-label col-xs-4 col-sm-2">主题</label>
							<div class="col-xs-8 col-sm-10">
								<input id="activityTitle" name="activityTitle" maxlength="300"
									class="form-control" type="text" />
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>

		<div class="panel panel-default table-panel">
			<div class="panel-body">
				<div class="tabbable-custom ">
					<ul class="nav nav-tabs">
						<li class="active"><a href="#activity_content"
							data-toggle="tab" id="brandTab">活动内容</a></li>
						<li><a href="#activity_scope" data-toggle="tab"
							id="seriesTab">活动范围</a></li>

					</ul>
					<div class="tab-content">
						<div class="tab-pane fade in active" id="activity_content"
							data-url="retail/vehicle/market/ServiceActivityManage/repairPart.html">
						</div>
						<div class="tab-pane  fade" id="activity_scope"
							data-url="retail/vehicle/market/ServiceActivityManage/repairMaterial.html">

						</div>

					</div>
				</div>
				<input type="hidden" id="fag" name="fag" />
			</div>
		</div>

		<div class="form-actions">
			<a 	data-url="/market/serviceActivityManage/save" data-model="retail"
				data-method="PUT" data-callBack="true" class="btn blue" data-beforeRequest="true"
				data-toggle="confirmation"><i class="fa fa-save"></i>保存 </a> 
			<a 	data-dismiss="modal" class="btn blue"> <i class="fa fa-undo"></i>取消 </a>
		</div>
	</form>
</div>
<script type="text/javascript">
$(document).one("onload.dms",function(event,container){
	$("#fag",container).val($("#fag",getElementContext()).val());
	$("a[data-callBack='true']",container).on("callBack.dms",function(event,response){
		$("a[data-goback='page']",container).click();
	});
    $("#brandTab",container).on("dms.click",function(event){
    	 $(this).tab('show');
	})
	$("select[id='isPartActivity']",container).bindChange(function(obj){
		if($("select[id='isPartActivity']",container).val()==12781001){
			$("select[id='isRepeatAttend']",container).selectpicker("val",12781002)
			dmsPart.initContextReadOnly(container,$("select[id='isRepeatAttend']",container));
		}else{
			dmsPart.removeElementsReadOnly(container,$("select[id='isRepeatAttend']",container));
		}
	});
    $("#activityAmount",container).bindChange(function(obj){
    	alert($("#activityAmount",container).val())
    });
    $("a[data-beforeRequest='true']",container).on("beforeRequest.dms",function(event,returnResult){
		if($("#mileageBegin",container).val()>$("#mileageEnd",container).val()){
			dmsCommon.tip({status:"warning",msg:"结束里程应大于开始里程，请正确输入！"});
			returnResult.status = false;
		}else{
			returnResult.status = true;
		}
    });
	$("a[data-callBack='true']",container).on("callBack.dms",function(event,response){
		$("#dms_table",getElementContext()).dmsTable().refreshTableWithForm();
		$("a[data-dismiss='modal']",container).click();
	});
});
</script>