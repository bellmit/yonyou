<div class="dms-search">
	<form class="form-horizontal" >
		<div class="panel panel-default">
			<div class="panel-body">
				<div class="row ">
				<div class="col-xs-12 col-sm-6 col-md-4 col-lg-3 " data-tableSelect="true">
						<div class="form-group">
								<label class="control-label col-xs-4">经销商代码</label>
								<div class="col-xs-8">
									<div class="input-group">
									<input id="dealerCode" readonly
										name="dealerCode" class="form-control" type="text"
										data-fieldName="dealer_code" /> <span
											class="input-group-btn" >
											<button class="btn default btn-sm" type="button"
												data-url="manage/basedata/dealers/searchDealers.html"
												data-toggle="modal" data-width="modal-lg">
												<i class="fa fa-list-alt"></i>
											</button>
											<button class="btn default input-clear" type="button">
												<i class="fa fa-close"></i>
											</button>
										</span>
									</div>
								</div>
							</div>
					</div>	
					<div class="col-xs-12 col-sm-6 col-md-4 col-lg-3 ">
						<div class="form-group">
							<label class="control-label col-xs-4 ">经销商名称</label>
							<div class="col-xs-8">
								<input type="text" class="form-control" id="dealerName" name="dealerName">
							</div>
						</div>
					</div>
					
					
									<!--  等待完善, 级联查询-->
						<div class="col-xs-12 col-sm-6 col-md-4 col-lg-3">
							<div class="form-group">
								<label class="control-label col-xs-4">销售大区</label>
								<div class="col-xs-8">
									<select id="bigOrg"
										class="bs-select form-control" name="bigOrgName"
										data-url="/salesSwitchChage/bigOrg"
										data-model="manage" data-labelValue="BIG_ORG"
										data-lableDesc="BIG_ORG_NAME"  data-live-search="fales" data-size="5">
									</select>
								</div>
							</div>
						</div>
						<div class="col-xs-12 col-sm-6 col-md-4 col-lg-3">
							<div class="form-group">
								<label class="control-label col-xs-4">销售小区</label>
								<div class="col-xs-8">
									<select id="smallOrg" parent="bigOrg"
										class="bs-select form-control" name="smallOrgName"
										data-url="/salesSwitchChage/{[bigOrg]}/smallOrg"
										data-model="manage" data-labelValue="SMALL_ORG"
										data-lableDesc="SMALL_ORG_NAME"  data-live-search="fales" data-size="5" >
									</select>	
								</div>
							</div>
						</div>
						
						
						
				</div>
				<div class="row ">
					<div class="col-xs-12 ">
						<div class="query-btn">
							<a class="btn blue" id="query" data-onclickEvent="true"> <i
								class="fa fa-search"></i> 查询
							</a> <a href="javascript:;" class="btn blue"><i
								class="fa fa-undo"></i> 重置</a>
						</div>
					</div>
				</div>
			</div>
		</div>
	</form>
		<div class="panel panel-default">
			<div class="panel-body">
				<div class="portlet light form-fit bordered">
					<div class="rows">
						<div class="col-xs-6" style="text-align:center;">
							<label  class="control-label">开关开启状态</label>
						</div>
						<div class="col-xs-6" style="text-align:center;">
							<label  class="control-label">开关关闭状态</label>
						</div>
					</div>
	               	<div class="portlet-body form">
					<div class="form-body">
		                <div class="form-group">
		                    <div class="col-xs-12">
								<table class="table table-bordered dchannel-table">
								     <tbody>
								      <tr class="item-default">
								          <td align="right" style="width: 50%;">
								              <select id="orgLeft" name="orgLeft" multiple="multiple" size="10" style="width:100%;" data-url="/salesSwitchChage/getOrgLeft"
												data-model="manage" data-labelValue="code" data-lableDesc="data" data-existsDefault="false">
								              </select>
								         </td>
								         <td style="width: 50px;" valign="middle">
								            <button type="button" class="btn btn-default btn-small" id="btn_select_all_org"><span class="glyphicon glyphicon-forward"></span></button>
								            <button type="button" class="btn btn-default btn-small" id="btn_choose_selected_org"><span class="glyphicon glyphicon-chevron-right"></span></button>
								            <button type="button" class="btn btn-default btn-small" id="btn_remove_selected_org"><span class="glyphicon glyphicon-chevron-left"></span></button>
								           <button type="button" class="btn btn-default btn-small" id="btn_remove_all_org"><span class="glyphicon glyphicon-backward"></span></button>
								        </td>
								        <td style="width: 50%;">
								              <select id="orgRight" name="orgRight" multiple="multiple" size="10" style="width:100%;" data-url="/salesSwitchChage/getOrgRight"
												data-model="manage" data-labelValue="code" data-lableDesc="data" data-existsDefault="false">
								              </select>
								     	 </td>
								    </tr>
								   </tbody>
							    </table>
		                    </div>
		                </div>
		             </div>
					 <div class="row" style="text-align:center;">
						<a  data-errorCallBack="true" data-onclickEvent="true" id="saveBef" data-info="saveBefore"  data-callBack="true"   class="btn blue" data-toggle="confirmation" data-model="manage" data-method="GET" ><i class="fa fa-save"></i> 保存
						</a>
						<a id="save" data-info="saveBeforeUrl" data-saveBeforeEvent="true" data-model="manage" data-onclickEvent="true"
							class="btn blue ajaxrest hidden" data-callBack="true"><i class="fa fa-save"></i>保存</a>
					</div>
	            </div>
			</div>
		</div>
	</div>
</div>
<script type="text/javascript">
$(document).one("onload.dms",function(event,container){
 	//大小区左右选择框
 	var orgLeft = $("#orgLeft"), orgRight = $("#orgRight");
 	      $("#btn_select_all_org").click(function(){
 	         orgLeft.find("option").each(function(){
 	             $(this).appendTo(orgRight);
 	            $(this).prop("selected",false);
 	         });
 	         return false;
 	     });
 	     $("#btn_choose_selected_org").click(function(){
          
 	       orgLeft.find("option:selected").each(function(){
 	            $(this).appendTo(orgRight);
 	           $(this).prop("selected",false);
 	        });
 	        return false;
 	    });
 	    $("#btn_remove_selected_org").click(function(){
 	         orgRight.find("option:selected").each(function(){
 	             $(this).appendTo(orgLeft);
 	            $(this).prop("selected",false);
 	         });
 	         return false;
 	     });
 	   $("#btn_remove_all_org").click(function(){
 	         orgRight.find("option").each(function(){
 	             $(this).appendTo(orgLeft);
 	            $(this).prop("selected",false);
 	         });
 	         orgRight.find("option").each(function(){
 	             $(this).appendTo(orgLeft);
 	            $(this).prop("selected",false);
 	         });
 	         return false;
 	     });
 	     orgLeft.find("option").on("dblclick", function(){
 	         if ($(this).closest("select").is(orgLeft)) {
 	             $("#btn_choose_selected_org").click();
 	         }
 	         else {
 	             $("#btn_remove_selected_org").click();
 	         }
 	         
 	         return false;
 	     });
 	     orgRight.find("option").on("dblclick", function(){
 	         if ($(this).closest("select").is(orgLeft)) {
 	             $("#btn_choose_selected_org").click();
 	         }
 	         else {
 	             $("#btn_remove_selected_org").click();
 	         }
 	         
 	         return false;
 	     });
 	     
 	     $("a#save[data-onclickEvent='true']", container).on("dms.click",function(event,returnResult){
			    var data = "";
			    $("#orgLeft option").each(function(i){
			    	data = data + $(this).val() + ","; 
			    });
			    data = data.substring(0,data.length-1);
			    data = data == "" ? "-1":data;
				dmsCommon.ajaxRestRequest({
					url : dmsCommon.getDmsPath()["manage"] + "/salesSwitchChage/saveChange/"+data,
					type : 'POST',
					sucessCallBack : function(data) {
						dmsCommon.tip({status:"success",msg:"保存成功"});
					},
	    			errorCallBack : function(data){
	    				dmsCommon.tip({status:"error",msg:"保存失败！"});
	    			}
				});
	     });
	     
	     $("a#saveBef[data-onclickEvent='true']", container).on("dms.onConfirm",function(event,returnResult){
	    	 $("#save").click();
	     });
	     
	     //查询按钮 
	     $("a#query[data-onclickEvent='true']", container).on("dms.click",function(event,returnResult){
	    	 if(isNull($("#dealerCode").val()) && isNull($("#dealerName").val()) && isNull($("#bigOrg").val()) && isNull($("#smallOrg").val())){
	    		 	return;
	    	 }else{    		 
		    	 dmsCommon.ajaxRestRequest({
		    			url:dmsCommon.getDmsPath()["manage"] + "/salesSwitchChage/searchOrg",
		    			type:"GET",
		    			data:{dealerCode:$("#dealerCode").val(),dealerName:$("#dealerName").val(),bigOrgName:$("#bigOrg").val(),smallOrgName:$("#smallOrg").val()},
		    			async:false,
		    			sucessCallBack : function(data) {
		    		    	 var left = $("#orgLeft option");
		    		    	 var right = $("#orgRight option");
	    			    	 left.each(function(i){
	    					    	$(this).prop("selected",false);
	    					    	if(data != '' && data.includes($(this).val())){
	    					    		$(this).prop("selected",true);
	    					    	}
	    					 });
	    			    	 right.each(function(i){
	    					    	$(this).prop("selected",false);
	    					    	if(data != '' && data.includes($(this).val())){
	    					    		$(this).prop("selected",true);
	    					    	}
	    					 });
		    			}
		    		});
	    	 }
	     });
	     
	     //判断非空
	     function isNull(data){
	    	 return (data == "" || data == undefined || data == null) ? true : false; 
	     }
	   
});
</script>