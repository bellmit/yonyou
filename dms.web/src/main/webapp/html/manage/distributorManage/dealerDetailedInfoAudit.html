<div class="dms-search">
	<form class="form-horizontal" >
		<div class="panel panel-default">
			<div class="panel-body">
				<div class="row ">
				<div class="col-xs-12 col-sm-6 col-md-4 col-lg-3 " data-tableSelect="true">
						<div class="form-group"> 
								<label class="control-label col-xs-4 ">经销商公司</label> 
 								<div class="col-xs-8">
									<div class="input-group">
									<input type="hidden" name="companyId" id="companyId" data-fieldName="COMPANY_ID">
									<!-- <input id="dealerName" readonly
										name="dealerName" class="form-control" type="text"
										data-fieldName="dealer_code" /> --> 
									<input id="companyShortName" readonly
										name="companyShortName" class="form-control" type="text"
										data-fieldName="COMPANY_SHORTNAME" />
										<span
											class="input-group-btn" >
											<button class="btn default btn-sm" type="button"
												data-url="manage/basedata/organization/searchCompany.html"
												data-toggle="modal" data-width="modal-lg">
												<i class="fa fa-list-alt"></i>
											</button>
											<button class="btn default input-clear" type="button">
												<i class="fa fa-close"></i>
											</button>
										</span>
									</div>
								</div>
							</div>
					</div>	
					<div class="col-xs-12 col-sm-6 col-md-4 col-lg-3 ">
						<div class="form-group">
							<label class="control-label col-xs-4 ">经销商代码</label>
							<div class="col-xs-8">
								<input type="text" class="form-control" id="dealerCode" name="dealerCode">
							</div>
						</div>
					</div>
					<!--/span-->
					<div class="col-xs-12 col-sm-6 col-md-4 col-lg-3 ">
						<div class="form-group">
							<label class="control-label col-xs-4">经销商简称</label>
							<div class="col-xs-8">
							<input type="hidden" id="dealerId" name="dealerId">
								<input type="text" class="form-control" id="dealerShortname" name="dealerShortname">
							</div>
						</div>
					</div>
					
					
						
					<div class="col-xs-12 col-sm-6 col-md-4 col-lg-3 "> 
							<div class="form-group">
								<label class="control-label col-xs-4">所属区域(小区)</label>
								<div class="col-xs-8">
									<div class="input-group">
									<input id="orgName" readonly
										name="orgName" class="form-control" type="text"
										/> 
										<input id="orgId" readonly
										name="orgId" class="form-control" type="hidden"
										/>
										<span
											class="input-group-btn" >
											<button class="btn default btn-sm" type="button"
												data-url="manage/distributorManage/searchsmallOrgAll.html"
												data-toggle="modal" data-width="modal-lg">
												<i class="fa fa-list-alt"></i>
											</button>
											<button class="btn default input-clear" type="button">
												<i class="fa fa-close"></i>
											</button>
										</span>
									</div>
								</div>
											
							</div>
						</div> 
					
					
					
					
					<div class="col-xs-12 col-sm-6 col-md-4 col-lg-3 ">
						<div class="form-group">
							<label class="control-label col-xs-4">经销商类型</label>
							<div class="col-xs-8">
								<select id="type" name="type" class="bs-select form-control" data-type="oemDict"  data-dictCode="1077" data-value="" >
								</select>
							</div>
						</div>
					</div>
					
					
		
						<div class="col-xs-12 col-sm-6 col-md-4 col-lg-3 ">
						<div class="form-group">
							<label class="control-label col-xs-4">是否官网</label>
							<div class="col-xs-8">
								<select id="isEc" name="isEc" class="bs-select form-control" data-type="oemDict" data-dictCode="1004"  >
								</select>
							</div>
						</div>
					</div>
						
							
				</div>
				<div class="row ">
					<div class="col-xs-12 ">
						<div class="query-btn">
							<a href="javascript:;" class="btn blue" data-onclickEvent="true"> <i
								class="fa fa-search" ></i> 查询
							</a> 
							<a href="javascript:;" class="btn blue"><i
								class="fa fa-undo"></i> 重置
							</a>
						</div>
					</div>
				</div>
			</div>
		</div>
		
	</form>
	<div class="panel panel-default table-panel">
			<div class="panel-heading">
				<div class="pannel-name" >经销商基本信息审核信息</div>
				<div class="pannel-button">
						<div class="btn-group btn-group-sm">
					
							<a id="testPass" data-url="/queryDealers/queryPass" data-model="manage" data-method="GET"
									class="btn btn-outline" data-toggle="confirmation" data-callBack="true" data-beforeRequest="true"><i class="fa fa-save"></i>通过</a> 
							<a id="testReject" class="btn btn-outline" data-url="/queryDealers/queryReject" data-model="manage" data-method="GET"
								data-toggle="confirmation" data-callBack="true" data-beforeRequest="true"> <i
								class="fa fa-print" ></i>驳回
							</a>
						 
						</div>						 
				</div>
		</div>
		<div class="panel-body">
			<table class="table table-striped table-bordered table-hover table-responsive"
				id="dms_table"></table>
		</div>
	</div>
	
</div>
<script type="text/javascript">
 $(document).one("onload.dms",function(event,container){
	new Datatable().initPagination({
		src : "dms_table",
		container:container,
		url : dmsCommon.getDmsPath()["manage"] + "/queryDealers/queryDealerAuditInfo",
		rowID : "DEALER_CODE",
		sortName : "DEALER_CODE",
		sortOrder : "asc",
		columns : [ 
		    {checkbox:true,sortable : false}, 
		    {field :"DEALER_ID",title : "操作",operateFormat : [
                {type:"edit",url:"manage/distributorManage/queryDealerInfo.html",openType:"jump",operateIcon:'<i class="fa fa-lg fa-list-alt "></i>',title:"详细"}
                ]
		    },
		    {field : "DEALER_CODE",title : "经销商代码"},
		    {field : "DEALER_SHORTNAME",title : "经销商简称"},
		    {field : "DEALER_TYPE",title : "经销商类型" ,codeFormat : {type:"oemDict",codeType:"1077"}},
		    {field : "ORG_NAME",title : "所属区域"},
		    {field : "COMPANY_SHORTNAME",title : "经销商公司"},
		    {field : "RANGES",title : "规模" , codeFormat : {type:"oemDict",codeType:"9028"}},
		    {field : "IS_EC",title : "是否官网" , codeFormat : {type:"oemDict",codeType:"1004"}},
		    {field : "CC_CODE",title : "CG Code/CJ Code" },
		    {field : "COMPANY_PHONE",title : "办公电话" },
		    {field : "OPEN_TIME",title : "营业时间" },
		    {field : "OPEN_RANGE",title : "经营范围" },
		    {field : "STATUS",title : "状态" , codeFormat : {type:"oemDict",codeType:"1001"}},
		    {field : "DEALER_STATUS",title : "经销商上报状态",codeFormat : {type:"oemDict",codeType:"4055"}},
		    {field : "DEALER_AUDIT_STATUS",title : "经销商审核状态",codeFormat : {type:"oemDict",codeType:"4056"}}
		]
	
	});
	
	
	$("#testPass,#testReject[data-beforeRequest='true']",container).on("beforeRequest.dms",function(event,returnResult){
		var selectRow = $("#dms_table",container).dmsTable().getSelections();
	
		if(!selectRow){
			dmsCommon.tip({status:"warning",msg:"请选择经销商"});//总共的状态类型info、success、error、warning
			returnResult.status = false;
			return ;
		}
		if(selectRow.length > 0){
			var dealerId = "";
			
			for(var i = 0 ;i<selectRow.length;i++){
				if(dealerId=="" ){ //第一次循环为空值
					dealerId = selectRow[i]["DEALER_ID"];
				}else{
					dealerId = dealerId+","+selectRow[i]["DEALER_ID"];
				}
				
			}
			$("#dealerId",container).setDmsValue(dealerId);
			
		}
		returnResult.status = true;
	});
	
	//通过或驳回 后置事件 
	$("a[data-callBack='true']",container).on("callBack.dms",function(event,response){		
		dmsCommon.tip({status:"success",msg:"操作成功"});
		$("#dms_table",container).dmsTable().refreshTableWithForm();
	});
	
});
    
</script>
